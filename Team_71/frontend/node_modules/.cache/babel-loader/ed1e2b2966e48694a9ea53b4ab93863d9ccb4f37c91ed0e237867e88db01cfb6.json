{"ast":null,"code":"import _objectSpread from\"/Users/abhinavpv/Desktop/insider-threat-detection/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate,useNavigate}from'react-router-dom';import{LineChart,Line,BarChart,Bar,PieChart,Pie,Cell,XAxis,YAxis,CartesianGrid,Tooltip,Legend,ResponsiveContainer}from'recharts';import{AlertTriangle,Shield,Users,Activity,TrendingUp,Clock,MapPin,FileText,Mail,HardDrive,Eye,ChevronRight,Search,Bell,RefreshCw,Home,BarChart3,AlertCircle,Zap,User,CheckCircle,Lock,LogIn,ArrowRight,Cpu,X}from'lucide-react';// Stored credentials\n// Note: All 50 users (U001-U050) use password 'user123'\n// Security admins must update this list when adding new users\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CREDENTIALS={admins:[{username:'admin',password:'admin123',name:'Security Admin 1',role:'admin'},{username:'secadmin',password:'secure123',name:'Security Admin 2',role:'admin'}],users:[// Demo users (U001-U003) - Real-time monitoring enabled\n{username:'U001',password:'user123',name:'Abhinav P V',role:'user'},{username:'U002',password:'user123',name:'Abhinav Gadde',role:'user'},{username:'U003',password:'user123',name:'Indushree',role:'user'}// Regular users (U004-U050) - Generated data\n// All follow pattern: username = User ID, password = 'user123'\n// Names are fetched from backend database\n]};// Helper function to check if user exists (for U004-U050)\nconst checkUserExists=async username=>{try{const API_URL=process.env.REACT_APP_API_URL||'http://localhost:8000';const response=await fetch(\"\".concat(API_URL,\"/api/users\"));if(response.ok){const users=await response.json();return users.find(u=>u.user_id===username);}}catch(error){console.error('Error checking user:',error);}return null;};// Authentication Context\nconst AuthContext=/*#__PURE__*/React.createContext();const useAuth=()=>{const context=React.useContext(AuthContext);if(!context){throw new Error('useAuth must be used within AuthProvider');}return context;};const AuthProvider=_ref=>{let{children}=_ref;const[currentUser,setCurrentUser]=useState(null);useEffect(()=>{const stored=localStorage.getItem('sentineliq_user');if(stored){setCurrentUser(JSON.parse(stored));}},[]);const login=async(username,password)=>{// Check admins\nconst admin=CREDENTIALS.admins.find(a=>a.username===username&&a.password===password);if(admin){const user={username:admin.username,name:admin.name,role:'admin',userId:null};setCurrentUser(user);localStorage.setItem('sentineliq_user',JSON.stringify(user));return{success:true,user};}// Check known users (U001-U003)\nconst regularUser=CREDENTIALS.users.find(u=>u.username===username&&u.password===password);if(regularUser){const user={username:regularUser.username,name:regularUser.name,role:'user',userId:regularUser.username};setCurrentUser(user);localStorage.setItem('sentineliq_user',JSON.stringify(user));return{success:true,user};}// Check if username matches pattern U004-U050 and password is correct\nif(username.match(/^U\\d{3}$/)&&password==='user123'){const userNum=parseInt(username.substring(1));if(userNum>=4&&userNum<=50){// Fetch user name from backend\nconst userFromDB=await checkUserExists(username);if(userFromDB){const user={username:username,name:userFromDB.name||username,role:'user',userId:username};setCurrentUser(user);localStorage.setItem('sentineliq_user',JSON.stringify(user));return{success:true,user};}}}return{success:false,message:'Invalid credentials'};};const logout=()=>{setCurrentUser(null);localStorage.removeItem('sentineliq_user');};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{currentUser,login,logout},children:children});};// Landing Page Component\nconst LandingPage=()=>{const navigate=useNavigate();return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-transparent backdrop-blur-sm border-b border-white/10 sticky top-0 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Shield,{className:\"w-10 h-10 text-indigo-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-white\",children:\"SentinelIQ\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"Insider Threat Detection\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/signin'),className:\"flex items-center space-x-2 px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition font-medium\",children:[/*#__PURE__*/_jsx(LogIn,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Login\"})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-6 py-20\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-full\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-indigo-300 text-sm font-semibold\",children:\"\\uD83D\\uDE80 AI-Powered Security Platform\"})}),/*#__PURE__*/_jsxs(\"h1\",{className:\"text-6xl font-bold text-white leading-tight\",children:[\"Detect Insider Threats\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400\",children:\"Before They Strike\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-gray-300 leading-relaxed\",children:\"Advanced AI/ML-powered platform that identifies suspicious behavior patterns, analyzes user activities, and prevents security breaches in real-time.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/signin'),className:\"flex items-center space-x-2 px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl transition font-semibold text-lg shadow-lg shadow-indigo-500/50\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Get Started\"}),/*#__PURE__*/_jsx(ArrowRight,{className:\"w-5 h-5\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"px-8 py-4 bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white rounded-xl transition font-semibold text-lg border border-white/20\",children:\"Watch Demo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-6 pt-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-white\",children:\"94.5%\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Detection Accuracy\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-white\",children:\"<1s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Response Time\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-white\",children:\"10K+\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Users Protected\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-3xl opacity-20 blur-3xl\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold\",children:\"Live Threat Detection\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 px-3 py-1 bg-green-500/20 border border-green-500/30 rounded-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-green-400 text-xs font-semibold\",children:\"Active\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-red-500/20 rounded-lg\",children:/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-6 h-6 text-red-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:\"High Risk Activity\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Off-hours file access detected\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400 font-bold\",children:\"ITS: 89\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-yellow-500/20 rounded-lg\",children:/*#__PURE__*/_jsx(Activity,{className:\"w-6 h-6 text-yellow-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:\"Anomaly Detected\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Unusual email patterns\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-400 font-bold\",children:\"ITS: 67\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-green-500/20 rounded-lg\",children:/*#__PURE__*/_jsx(CheckCircle,{className:\"w-6 h-6 text-green-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:\"Normal Activity\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Standard user behavior\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-green-400 font-bold\",children:\"ITS: 23\"})]})]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-32\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-16\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-4xl font-bold text-white mb-4\",children:\"Comprehensive Security Features\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-gray-400\",children:\"Everything you need to protect your organization\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\",children:[{icon:Cpu,title:'AI/ML Detection',description:'Ensemble ML models with 89.8% accuracy (XGBoost + Random Forest + Isolation Forest)',color:'indigo'},{icon:Activity,title:'Real-Time Monitoring',description:'Sub-second threat detection and alerting',color:'purple'},{icon:Users,title:'User Intelligence',description:'Comprehensive behavioral analytics and profiling',color:'blue'},{icon:Zap,title:'Attack Simulation',description:'Interactive threat scenario testing',color:'red'}].map((feature,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-2xl hover:border-indigo-500/50 transition group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block p-3 bg-\".concat(feature.color,\"-500/20 rounded-xl mb-4 group-hover:scale-110 transition\"),children:/*#__PURE__*/_jsx(feature.icon,{className:\"w-8 h-8 text-\".concat(feature.color,\"-400\")})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-white mb-2\",children:feature.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:feature.description})]},idx))})]})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-slate-900/50 backdrop-blur-sm border-t border-white/10 mt-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Shield,{className:\"w-8 h-8 text-indigo-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-semibold\",children:\"SentinelIQ\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"\\xA9 2024 All rights reserved\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Built by Abhinav P V, Abhinav Gadde, Indushree\"})]})})})]});};// Sign In Page Component\nconst SignInPage=()=>{const navigate=useNavigate();const{login}=useAuth();const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleSignIn=async e=>{e.preventDefault();setLoading(true);setError('');try{const result=await login(username,password);if(result.success){navigate('/dashboard');}else{setError(result.message||'Invalid credentials');}}catch(error){setError('Login failed. Please try again.');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8 items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hidden lg:block space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Shield,{className:\"w-12 h-12 text-indigo-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-white\",children:\"SentinelIQ\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Insider Threat Detection\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-5xl font-bold text-white leading-tight\",children:\"Welcome Back!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-gray-300\",children:\"Sign in to access your security dashboard and monitor threats in real-time.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-2\",children:[/*#__PURE__*/_jsx(Cpu,{className:\"w-6 h-6 text-indigo-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl font-bold text-white\",children:\"94.5%\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"ML Accuracy\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-2\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-6 h-6 text-green-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl font-bold text-white\",children:\"<1s\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Response Time\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-3xl p-10 shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:hidden flex items-center space-x-3 mb-8\",children:[/*#__PURE__*/_jsx(Shield,{className:\"w-10 h-10 text-indigo-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-white\",children:\"SentinelIQ\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Insider Threat Detection\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-white mb-2\",children:\"Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Access your security dashboard\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-xl\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400 text-sm\",children:error})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSignIn,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"Username\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(User,{className:\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value),className:\"w-full pl-12 pr-4 py-4 bg-slate-900/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\",placeholder:\"Enter your username\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Lock,{className:\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),className:\"w-full pl-12 pr-4 py-4 bg-slate-900/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\",placeholder:\"Enter your password\",required:true})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"w-full flex items-center justify-center space-x-2 px-6 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl transition font-semibold text-lg shadow-lg shadow-indigo-500/50 disabled:opacity-50\",children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Logging in...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Login\"}),/*#__PURE__*/_jsx(ArrowRight,{className:\"w-5 h-5\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 pt-8 border-t border-white/10\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 text-center\",children:\"Contact your security administrator for login credentials\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"mt-6 text-indigo-400 hover:text-indigo-300 text-sm font-medium\",children:\"\\u2190 Back to Home\"})]})]})})]})});};// Activity Timeline Component with Real-time Updates\nconst ActivityTimeline=_ref2=>{let{activities}=_ref2;const[currentTime,setCurrentTime]=useState(new Date());// Update current time every minute for real-time \"ago\" display\nuseEffect(()=>{const interval=setInterval(()=>{setCurrentTime(new Date());},60000);// Update every minute\nreturn()=>clearInterval(interval);},[]);const formatTimeAgo=timestamp=>{const activityDate=new Date(timestamp);const diffMs=currentTime-activityDate;// If timestamp is in the future (shouldn't happen, but handle it gracefully)\nif(diffMs<0){return'Just now';// Treat future timestamps as \"just now\"\n}const diffMins=Math.floor(diffMs/60000);const diffHours=Math.floor(diffMins/60);const diffDays=Math.floor(diffHours/24);if(diffMins<1){return'Just now';}else if(diffMins<60){return\"\".concat(diffMins).concat(diffMins===1?' minute':' minutes',\" ago\");}else if(diffHours<24){return\"\".concat(diffHours).concat(diffHours===1?' hour':' hours',\" ago\");}else if(diffDays<7){return\"\".concat(diffDays).concat(diffDays===1?' day':' days',\" ago\");}else{return activityDate.toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'});}};const formatTimestamp=timestamp=>{const date=new Date(timestamp);const now=new Date();// If timestamp is in the future, show current time instead (shouldn't happen, but handle it)\nif(date>now){return now.toLocaleString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'numeric',minute:'2-digit',hour12:true});}// Format: \"Nov 14, 2024, 2:30 PM\" (realistic format)\nreturn date.toLocaleString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'numeric',minute:'2-digit',hour12:true});};return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 max-h-96 overflow-y-auto\",children:activities.map((activity,idx)=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 mt-1\",children:[activity.activity_type==='logon'&&/*#__PURE__*/_jsx(Activity,{className:\"w-5 h-5 text-blue-600\"}),activity.activity_type==='logoff'&&/*#__PURE__*/_jsx(Clock,{className:\"w-5 h-5 text-gray-600\"}),activity.activity_type==='file_access'&&/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5 text-green-600\"}),activity.activity_type==='email'&&/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 text-purple-600\"}),activity.activity_type==='device'&&/*#__PURE__*/_jsx(HardDrive,{className:\"w-5 h-5 text-orange-600\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900 font-medium capitalize text-sm\",children:activity.activity_type.replace('_',' ')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 font-medium\",children:formatTimeAgo(activity.timestamp)})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:formatTimestamp(activity.timestamp)}),activity.details&&typeof activity.details==='object'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 space-y-1\",children:[activity.activity_type==='logon'&&/*#__PURE__*/_jsxs(_Fragment,{children:[activity.details.ip&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"IP: \",activity.details.ip]}),activity.details.device&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"Device: \",activity.details.device]})]}),activity.activity_type==='file_access'&&/*#__PURE__*/_jsxs(_Fragment,{children:[activity.details.file_path&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"File: \",activity.details.file_path]}),activity.details.action&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"Action: \",activity.details.action]}),activity.details.sensitivity&&/*#__PURE__*/_jsxs(\"span\",{className:\"inline-block mt-1 px-2 py-0.5 rounded text-xs font-medium \".concat(activity.details.sensitivity==='high'?'bg-red-100 text-red-700':activity.details.sensitivity==='medium'?'bg-yellow-100 text-yellow-700':'bg-green-100 text-green-700'),children:[activity.details.sensitivity,\" sensitivity\"]})]}),activity.activity_type==='email'&&/*#__PURE__*/_jsxs(_Fragment,{children:[activity.details.recipient&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"To: \",activity.details.recipient]}),activity.details.external!==undefined&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-1 px-2 py-0.5 rounded text-xs font-medium \".concat(activity.details.external?'bg-orange-100 text-orange-700':'bg-blue-100 text-blue-700'),children:activity.details.external?'External':'Internal'})]})]})]})]},idx);})});};// New Incident Form Component\nconst NewIncidentForm=_ref3=>{let{users,onClose,onSuccess,showNotification,API_URL}=_ref3;const[formData,setFormData]=useState({user_id:'',severity:'medium',description:'',explanation:''});const[loading,setLoading]=useState(false);const handleSubmit=async e=>{e.preventDefault();if(!formData.user_id||!formData.description){showNotification('Please fill in all required fields','error');return;}setLoading(true);try{const response=await fetch(\"\".concat(API_URL,\"/api/incidents\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id:formData.user_id,severity:formData.severity,description:formData.description,explanation:formData.explanation||formData.description})});if(response.ok){onSuccess();}else{const error=await response.json();showNotification(error.detail||'Failed to create incident','error');}}catch(error){showNotification('Error creating incident','error');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"User \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:formData.user_id,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{user_id:e.target.value})),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a user...\"}),users.map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.user_id,children:[user.name,\" (\",user.user_id,\") - \",user.risk_level||'low',\" risk\"]},user.user_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Severity \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:formData.severity,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{severity:e.target.value})),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High\"}),/*#__PURE__*/_jsx(\"option\",{value:\"critical\",children:\"Critical\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Description \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),placeholder:\"Brief description of the incident...\",className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Detailed Explanation\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.explanation,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{explanation:e.target.value})),placeholder:\"Provide detailed information about the incident...\",rows:4,className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium disabled:opacity-50\",children:loading?'Creating...':'Create Incident'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\",children:\"Cancel\"})]})]});};// Main Dashboard Component\nconst Dashboard=()=>{var _users$,_users$$risk_level,_users$0$risk_level,_selectedUser$its_sco;const navigate=useNavigate();const{currentUser,logout}=useAuth();const[isLoading,setIsLoading]=useState(true);const[activeView,setActiveView]=useState('overview');const[selectedUser,setSelectedUser]=useState(null);const[searchQuery,setSearchQuery]=useState('');const[filterRisk,setFilterRisk]=useState('all');const[refreshing,setRefreshing]=useState(false);const API_URL=process.env.REACT_APP_API_URL||'http://localhost:8000';const[users,setUsers]=useState([]);const[userActivities,setUserActivities]=useState([]);const[dashboardStats,setDashboardStats]=useState({total_users:0,high_risk_users:0,active_threats:0,average_its:0,alerts_today:0,ensemble_accuracy:null});// New state for all tabs\nconst[incidents,setIncidents]=useState([]);const[intelligenceData,setIntelligenceData]=useState(null);const[analyticsData,setAnalyticsData]=useState(null);const[alerts,setAlerts]=useState([]);const[simulationRunning,setSimulationRunning]=useState(false);const[notification,setNotification]=useState(null);const[showNewIncidentModal,setShowNewIncidentModal]=useState(false);const[showResolveModal,setShowResolveModal]=useState(false);const[selectedIncident,setSelectedIncident]=useState(null);const[resolveNotes,setResolveNotes]=useState('');const[itsScoreTrend,setItsScoreTrend]=useState([]);const[showLogoutConfirm,setShowLogoutConfirm]=useState(false);// Wait for AuthProvider to restore user from localStorage on mount\nuseEffect(()=>{const stored=localStorage.getItem('sentineliq_user');if(stored){// User exists in localStorage - AuthProvider will restore it\n// Wait a moment for AuthProvider to restore, then check\nconst timer=setTimeout(()=>{setIsLoading(false);},100);return()=>clearTimeout(timer);}else{// No stored user - user is logged out\nsetIsLoading(false);}},[]);// Only run on mount\n// Watch for currentUser changes - if it gets restored, stop loading\nuseEffect(()=>{if(currentUser){setIsLoading(false);}},[currentUser]);// Fetch users from API\nuseEffect(()=>{const fetchUsers=async()=>{try{const response=await fetch(\"\".concat(API_URL,\"/api/users\"));if(response.ok){const data=await response.json();// If user role, filter to show only their data\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'){const userProfile=data.find(u=>u.user_id===currentUser.userId);setUsers(userProfile?[userProfile]:[]);}else{setUsers(data||[]);}}}catch(error){console.error('Error fetching users:',error);}};if(currentUser){fetchUsers();const interval=setInterval(fetchUsers,5000);// Refresh every 5 seconds for real-time updates\nreturn()=>clearInterval(interval);}},[API_URL,currentUser]);// Fetch dashboard stats with real-time updates\nuseEffect(()=>{const fetchStats=async()=>{try{const response=await fetch(\"\".concat(API_URL,\"/api/dashboard/stats\"));if(response.ok){const data=await response.json();// If user role, show only their stats\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'){const userProfile=users.find(u=>u.user_id===currentUser.userId);// Fetch user's alert count\ntry{const userAlertsResponse=await fetch(\"\".concat(API_URL,\"/api/alerts?user_id=\").concat(currentUser.userId,\"&limit=50\"));let userAlertCount=0;if(userAlertsResponse.ok){const userAlertsData=await userAlertsResponse.json();userAlertCount=(userAlertsData||[]).filter(a=>!a.is_viewed).length;}setDashboardStats({total_users:1,high_risk_users:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='high'||(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,active_threats:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,average_its:(userProfile===null||userProfile===void 0?void 0:userProfile.its_score)||0,alerts_today:userAlertCount,ensemble_accuracy:null});}catch(error){console.error('Error fetching user alerts:',error);setDashboardStats({total_users:1,high_risk_users:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='high'||(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,active_threats:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,average_its:(userProfile===null||userProfile===void 0?void 0:userProfile.its_score)||0,alerts_today:0,ensemble_accuracy:null});}}else{setDashboardStats({total_users:data.total_users||0,high_risk_users:data.high_risk_users||0,active_threats:data.active_threats||0,average_its:parseFloat(data.average_its||0).toFixed(1),alerts_today:data.alerts_today||0,ensemble_accuracy:data.ensemble_accuracy||null});}}}catch(error){console.error('Error fetching stats:',error);}};if(currentUser){fetchStats();const interval=setInterval(fetchStats,3000);// Refresh every 3 seconds for real-time updates\nreturn()=>clearInterval(interval);}},[API_URL,currentUser,users]);// REAL-TIME ALERT POLLING - Fetch alerts every 3 seconds (for both admin and user)\nuseEffect(()=>{const fetchAlerts=async()=>{if(!currentUser)return;try{// For users, fetch only their alerts; for admin, fetch all\nconst url=currentUser.role==='admin'?\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false\"):\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false&user_id=\").concat(currentUser.userId);const response=await fetch(url);if(response.ok){const data=await response.json();setAlerts(data||[]);// Update alerts count in dashboard stats (only for admin)\nif(currentUser.role==='admin'){const unreadCount=(data||[]).filter(a=>!a.is_viewed).length;setDashboardStats(prev=>_objectSpread(_objectSpread({},prev),{},{alerts_today:unreadCount}));}else{// For users, update their personal alert count\nconst userAlertCount=(data||[]).filter(a=>!a.is_viewed).length;setDashboardStats(prev=>_objectSpread(_objectSpread({},prev),{},{alerts_today:userAlertCount}));}}}catch(error){console.error('Error fetching alerts:',error);}};if(currentUser){fetchAlerts();const interval=setInterval(fetchAlerts,3000);// Poll every 3 seconds\nreturn()=>clearInterval(interval);}},[API_URL,currentUser]);// REAL-TIME INCIDENT POLLING - Fetch incidents every 5 seconds (admin only)\nuseEffect(()=>{const fetchIncidents=async()=>{if(!currentUser||currentUser.role!=='admin')return;try{const response=await fetch(\"\".concat(API_URL,\"/api/incidents?limit=100\"));if(response.ok){const data=await response.json();// Transform backend format to frontend format\nconst transformedIncidents=(data||[]).map(inc=>({id:inc.incident_id||inc.id||\"INC\".concat(inc.incident_id||inc.alert_id||0),incident_id:inc.incident_id||inc.id,alert_id:inc.incident_id||inc.alert_id,user_id:inc.user_id,user:inc.user_name||inc.user||'Unknown',user_name:inc.user_name||inc.user,severity:inc.severity,status:inc.status||'open',created:inc.created_at||inc.timestamp||inc.created,created_at:inc.created_at||inc.timestamp||inc.created,timestamp:inc.timestamp||inc.created_at||inc.created,description:inc.description||inc.explanation||'',its_score:inc.its_score||0,incident_type:inc.incident_type||'suspicious_activity',assigned_to:inc.assigned_to||'Security Team',resolution_notes:inc.resolution_notes||null,resolved_at:inc.resolved_at||null}));setIncidents(transformedIncidents);}}catch(error){console.error('Error fetching incidents:',error);}};if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'){fetchIncidents();const interval=setInterval(fetchIncidents,5000);// Poll every 5 seconds\nreturn()=>clearInterval(interval);}},[API_URL,currentUser]);const fetchUserActivities=async userId=>{try{const response=await fetch(\"\".concat(API_URL,\"/api/users/\").concat(userId,\"/activities?days=7\"));if(response.ok){const data=await response.json();setUserActivities(data.activities||[]);}}catch(error){console.error('Error fetching activities:',error);}};const selectUser=user=>{setSelectedUser(user);fetchUserActivities(user.user_id);setActiveView('user-detail');};const handleRefresh=async()=>{setRefreshing(true);try{const response=await fetch(\"\".concat(API_URL,\"/api/users\"));if(response.ok){const data=await response.json();if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'){const userProfile=data.find(u=>u.user_id===currentUser.userId);setUsers(userProfile?[userProfile]:[]);}else{setUsers(data||[]);}}}catch(error){console.error('Error refreshing:',error);}setTimeout(()=>setRefreshing(false),500);};const handleLogout=()=>{// Show confirmation modal instead of directly logging out\nsetShowLogoutConfirm(true);};const confirmLogout=()=>{// Actually perform logout after confirmation\nlogout();setShowLogoutConfirm(false);navigate('/signin');};const getRiskColor=riskLevel=>{if(!riskLevel)return'#6b7280';switch(riskLevel.toLowerCase()){case'critical':return'#dc2626';case'high':return'#ef4444';case'medium':return'#f59e0b';case'low':return'#10b981';default:return'#6b7280';}};const getRiskBadge=riskLevel=>{if(!riskLevel)return'bg-gray-100 text-gray-800 border-gray-300';switch(riskLevel.toLowerCase()){case'critical':return'bg-red-100 text-red-800 border-red-300';case'high':return'bg-red-100 text-red-800 border-red-300';case'medium':return'bg-yellow-100 text-yellow-800 border-yellow-300';case'low':return'bg-green-100 text-green-800 border-green-300';default:return'bg-gray-100 text-gray-800 border-gray-300';}};const filteredUsers=users.filter(user=>{const matchesSearch=user.name.toLowerCase().includes(searchQuery.toLowerCase())||user.user_id.toLowerCase().includes(searchQuery.toLowerCase());const matchesFilter=filterRisk==='all'||user.risk_level===filterRisk;return matchesSearch&&matchesFilter;});const riskDistribution=[{name:'Low',value:users.filter(u=>u.risk_level==='low').length,color:'#10b981'},{name:'Medium',value:users.filter(u=>u.risk_level==='medium').length,color:'#f59e0b'},{name:'High',value:users.filter(u=>u.risk_level==='high').length,color:'#ef4444'},{name:'Critical',value:users.filter(u=>u.risk_level==='critical').length,color:'#dc2626'}].filter(item=>item.value>0);// Only show categories with values > 0\n// Fetch historical ITS scores for trend chart\nconst fetchHistoricalITS=async userId=>{try{const response=await fetch(\"\".concat(API_URL,\"/api/users/\").concat(userId,\"/historical-its?days=7\"));if(response.ok){const data=await response.json();if(data.trend&&data.trend.length>0){setItsScoreTrend(data.trend);}else{// Fallback: use current score for all days if no historical data\nconst currentUser=users.find(u=>u.user_id===userId)||users[0];const currentScore=(currentUser===null||currentUser===void 0?void 0:currentUser.its_score)||0;const fallbackTrend=Array.from({length:7},(_,i)=>({day:\"Day \".concat(i+1),score:i===6?currentScore:0,// Only show current score for today\nalerts:i===6?dashboardStats.alerts_today||0:0}));setItsScoreTrend(fallbackTrend);}}}catch(error){console.error('Error fetching historical ITS:',error);// Fallback on error\nconst currentUser=users.find(u=>u.user_id===userId)||users[0];const currentScore=(currentUser===null||currentUser===void 0?void 0:currentUser.its_score)||0;const fallbackTrend=Array.from({length:7},(_,i)=>({day:\"Day \".concat(i+1),score:i===6?currentScore:0,alerts:i===6?dashboardStats.alerts_today||0:0}));setItsScoreTrend(fallbackTrend);}};// Fetch data when tabs are active\nuseEffect(()=>{if(!currentUser||currentUser.role!=='admin')return;const fetchTabData=async()=>{try{if(activeView==='incidents'){const response=await fetch(\"\".concat(API_URL,\"/api/incidents?limit=100\"));if(response.ok){const data=await response.json();// Transform backend format to frontend format\nconst transformedIncidents=(data||[]).map(inc=>{// Extract numeric ID from formatted string (e.g., \"INC00001\" -> 1)\nlet numericId=null;if(inc.incident_id){// If it's a formatted string like \"INC00001\", extract the number\nconst match=String(inc.incident_id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}// Fallback to direct numeric value if available\nif(!numericId&&typeof inc.incident_id==='number'){numericId=inc.incident_id;}// Last resort: try to extract from id field\nif(!numericId&&inc.id){const match=String(inc.id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}return{id:inc.incident_id||inc.id||\"INC\".concat(numericId||0),incident_id:inc.incident_id||inc.id,incident_id_numeric:numericId,// Store numeric ID for API calls\nalert_id:inc.incident_id||inc.alert_id,user_id:inc.user_id,user:inc.user_name||inc.user||'Unknown',user_name:inc.user_name||inc.user,severity:inc.severity,status:inc.status||'open',created:inc.created_at||inc.timestamp||inc.created,created_at:inc.created_at||inc.timestamp||inc.created,timestamp:inc.timestamp||inc.created_at||inc.created,description:inc.description||inc.explanation||'',its_score:inc.its_score||0,incident_type:inc.incident_type||'suspicious_activity',assigned_to:inc.assigned_to||'Security Team',resolution_notes:inc.resolution_notes||null,resolved_at:inc.resolved_at||null};});setIncidents(transformedIncidents);}}else if(activeView==='alerts'){// Fetch alerts (user-specific for users, all for admin)\nconst alertsUrl=(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'?\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false\"):\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false&user_id=\").concat(currentUser===null||currentUser===void 0?void 0:currentUser.userId);const response=await fetch(alertsUrl);if(response.ok){const data=await response.json();setAlerts(data||[]);// Mark all alerts as viewed when tab is opened (only for admin)\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'&&data&&data.length>0){fetch(\"\".concat(API_URL,\"/api/alerts/mark-viewed\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({alert_ids:null})// null means mark all\n}).then(()=>{// Refresh dashboard stats to update badge count\nrefreshDashboardData();});}}}else if(activeView==='analytics'){const response=await fetch(\"\".concat(API_URL,\"/api/analytics/models\"));if(response.ok){const data=await response.json();setAnalyticsData(data);}}else if(activeView==='intelligence'&&selectedUser){const response=await fetch(\"\".concat(API_URL,\"/api/intelligence/\").concat(selectedUser.user_id));if(response.ok){const data=await response.json();setIntelligenceData(data);}}}catch(error){console.error('Error fetching tab data:',error);}};fetchTabData();},[activeView,API_URL,currentUser,selectedUser]);// Check authentication status\nconst stored=localStorage.getItem('sentineliq_user');// Show loading state while checking authentication\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Loading...\"})]})});}// If we have localStorage but no currentUser yet, wait for AuthProvider to restore\nif(!currentUser&&stored){// Give AuthProvider more time to restore - don't redirect\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Restoring session...\"})]})});}// Only redirect if there's no user AND no localStorage (user explicitly logged out)\nif(!currentUser&&!stored){// User is truly logged out - redirect to signin\nnavigate('/signin');return null;}// Notification component\nconst showNotification=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setNotification({message,type});setTimeout(()=>setNotification(null),5000);};// Refresh all dashboard data\nconst refreshDashboardData=async()=>{try{// Refresh users\nconst usersResponse=await fetch(\"\".concat(API_URL,\"/api/users\"));if(usersResponse.ok){const usersData=await usersResponse.json();if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'){const userProfile=usersData.find(u=>u.user_id===currentUser.userId);setUsers(userProfile?[userProfile]:[]);}else{setUsers(usersData||[]);}}// Refresh stats\nconst statsResponse=await fetch(\"\".concat(API_URL,\"/api/dashboard/stats\"));if(statsResponse.ok){const statsData=await statsResponse.json();if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'){const userProfile=users.find(u=>u.user_id===currentUser.userId);// Fetch user's alert count\ntry{const userAlertsResponse=await fetch(\"\".concat(API_URL,\"/api/alerts?user_id=\").concat(currentUser.userId,\"&limit=50\"));let userAlertCount=0;if(userAlertsResponse.ok){const userAlertsData=await userAlertsResponse.json();userAlertCount=(userAlertsData||[]).filter(a=>!a.is_viewed).length;}setDashboardStats({total_users:1,high_risk_users:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='high'||(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,active_threats:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,average_its:(userProfile===null||userProfile===void 0?void 0:userProfile.its_score)||0,alerts_today:userAlertCount,ensemble_accuracy:null});}catch(error){console.error('Error fetching user alerts:',error);setDashboardStats({total_users:1,high_risk_users:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='high'||(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,active_threats:(userProfile===null||userProfile===void 0?void 0:userProfile.risk_level)==='critical'?1:0,average_its:(userProfile===null||userProfile===void 0?void 0:userProfile.its_score)||0,alerts_today:0,ensemble_accuracy:null});}}else{setDashboardStats({total_users:statsData.total_users||0,high_risk_users:statsData.high_risk_users||0,active_threats:statsData.active_threats||0,average_its:parseFloat(statsData.average_its||0).toFixed(1),alerts_today:statsData.alerts_today||0,ensemble_accuracy:statsData.ensemble_accuracy||null});}}// Refresh alerts (user-specific for users, all for admin)\nif(currentUser){const alertsUrl=currentUser.role==='admin'?\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false\"):\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false&user_id=\").concat(currentUser.userId);const alertsResponse=await fetch(alertsUrl);if(alertsResponse.ok){const alertsData=await alertsResponse.json();setAlerts(alertsData||[]);}}// Refresh incidents\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'){const incidentsResponse=await fetch(\"\".concat(API_URL,\"/api/incidents\"));if(incidentsResponse.ok){const incidentsData=await incidentsResponse.json();setIncidents(incidentsData||[]);}}// Refresh activities for:\n// 1. Selected user (if admin viewing user detail)\n// 2. Current user (if regular user viewing their own timeline)\nif(selectedUser){await fetchUserActivities(selectedUser.user_id);await fetchHistoricalITS(selectedUser.user_id);}else if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'&&currentUser!==null&&currentUser!==void 0&&currentUser.userId){// Regular user viewing their own timeline\nawait fetchUserActivities(currentUser.userId);await fetchHistoricalITS(currentUser.userId);}else if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'&&users.length>0){// Admin: fetch trend for first user or average\nconst firstUser=users[0];if(firstUser){await fetchHistoricalITS(firstUser.user_id);}}}catch(error){console.error('Error refreshing dashboard:',error);}};// Fetch historical ITS on mount and when users change\nuseEffect(()=>{if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='user'&&currentUser!==null&&currentUser!==void 0&&currentUser.userId){fetchHistoricalITS(currentUser.userId);}else if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'&&users.length>0){// For admin, use first user or calculate average\nconst firstUser=users[0];if(firstUser){fetchHistoricalITS(firstUser.user_id);}}},[currentUser,users,API_URL]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[notification&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed top-4 right-4 z-[9999] max-w-md transform transition-all duration-300 \".concat(notification?'translate-x-0 opacity-100':'translate-x-full opacity-0',\" \").concat(notification.type==='success'?'bg-green-500':notification.type==='error'?'bg-red-500':'bg-blue-500',\" text-white px-6 py-4 rounded-lg shadow-2xl flex items-start space-x-3 border-l-4 \").concat(notification.type==='success'?'border-green-600':notification.type==='error'?'border-red-600':'border-blue-600'),style:{zIndex:9999},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-sm\",children:notification.type==='success'?'✅ Success':notification.type==='error'?'❌ Error':'ℹ️ Info'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1 leading-relaxed\",children:notification.message})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setNotification(null),className:\"text-white hover:text-gray-200 transition flex-shrink-0\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"header\",{className:\"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-600 p-2 rounded-lg\",children:/*#__PURE__*/_jsx(Shield,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-900\",children:\"SentinelIQ Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:currentUser.role==='admin'?'Security Operations Center':\"\".concat(currentUser.name,\" - User Portal\")})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleRefresh,className:\"flex items-center space-x-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition text-sm\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4 text-gray-600 \".concat(refreshing?'animate-spin':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700\",children:\"Refresh\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 px-3 py-2 bg-green-50 border border-green-200 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-green-700 font-medium\",children:\"Active\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView('alerts'),className:\"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition relative\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5 text-gray-600\"}),dashboardStats.alerts_today>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-semibold\",children:dashboardStats.alerts_today})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 bg-indigo-50 border border-indigo-200 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-indigo-900 font-medium\",children:currentUser.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-indigo-600\",children:currentUser.role==='admin'?'Admin':'User'})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"flex items-center space-x-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium text-gray-700\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Logout\"})})]})]})})}),showLogoutConfirm&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]\",style:{zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Confirm Logout\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Do you want to logout?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLogoutConfirm(false),className:\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmLogout,className:\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-medium\",children:\"OK\"})]})]})]})}),/*#__PURE__*/_jsx(\"nav\",{className:\"bg-white border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-3 flex space-x-1 overflow-x-auto\",children:(currentUser.role==='admin'?[{id:'overview',label:'Overview',icon:Home},{id:'users',label:'Users',icon:Users},{id:'alerts',label:'Alerts',icon:AlertTriangle},{id:'analytics',label:'Analytics',icon:BarChart3},{id:'incidents',label:'Incidents',icon:AlertCircle},{id:'intelligence',label:'Intelligence',icon:User},{id:'simulation',label:'Simulation',icon:Zap}]:[{id:'overview',label:'Overview',icon:Home},{id:'alerts',label:'My Alerts',icon:AlertTriangle}]).map(view=>{const IconComponent=view.icon;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView(view.id),className:\"flex items-center space-x-2 px-4 py-2 rounded-lg transition text-sm font-medium whitespace-nowrap \".concat(activeView===view.id?'bg-indigo-50 text-indigo-700 border border-indigo-200':'text-gray-600 hover:text-gray-900 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(IconComponent,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:view.label})]},view.id);})})}),\")}\",activeView==='overview'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm font-medium\",children:currentUser.role==='admin'?'Total Users':'My Profile'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-gray-900 mt-1\",children:dashboardStats.total_users}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-1\",children:currentUser.role==='admin'?'Monitored employees':'Active user'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-indigo-50 rounded-lg\",children:/*#__PURE__*/_jsx(Users,{className:\"w-6 h-6 text-indigo-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm font-medium\",children:currentUser.role==='admin'?'High Risk Users':'My Risk Level'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-red-600 mt-1\",children:dashboardStats.high_risk_users}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-red-400 mt-1\",children:currentUser.role==='admin'?'Require attention':((_users$=users[0])===null||_users$===void 0?void 0:(_users$$risk_level=_users$.risk_level)===null||_users$$risk_level===void 0?void 0:_users$$risk_level.toUpperCase())||'N/A'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-red-50 rounded-lg\",children:/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-6 h-6 text-red-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm font-medium\",children:currentUser.role==='admin'?'Alerts Today':'My Alerts'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-orange-600 mt-1\",children:dashboardStats.alerts_today}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-orange-400 mt-1\",children:\"Generated alerts\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-orange-50 rounded-lg\",children:/*#__PURE__*/_jsx(Bell,{className:\"w-6 h-6 text-orange-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm font-medium\",children:currentUser.role==='admin'?'Average ITS':'My ITS Score'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-blue-600 mt-1\",children:dashboardStats.average_its}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-blue-400 mt-1\",children:currentUser.role==='admin'?'System average':'Threat score'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-blue-50 rounded-lg\",children:/*#__PURE__*/_jsx(TrendingUp,{className:\"w-6 h-6 text-blue-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm font-medium\",children:\"Active Threats\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-purple-600 mt-1\",children:dashboardStats.active_threats}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-purple-400 mt-1\",children:\"Priority users\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-purple-50 rounded-lg\",children:/*#__PURE__*/_jsx(Activity,{className:\"w-6 h-6 text-purple-600\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold mb-4 text-gray-900\",children:\"ITS Score Trend (Last 7 Days)\"}),itsScoreTrend.length>0?/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(LineChart,{data:itsScoreTrend,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"day\",stroke:\"#6b7280\"}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\"}),/*#__PURE__*/_jsx(Tooltip,{contentStyle:{backgroundColor:'#ffffff',border:'1px solid #e5e7eb',borderRadius:'8px',boxShadow:'0 4px 6px -1px rgba(0, 0, 0, 0.1)'}}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"score\",stroke:\"#6366f1\",strokeWidth:2,name:\"ITS Score\",dot:{r:4}}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"alerts\",stroke:\"#ef4444\",strokeWidth:2,name:\"Alerts\",dot:{r:4}})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"h-[300px] flex items-center justify-center text-gray-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading historical data...\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold mb-4 text-gray-900\",children:\"Risk Distribution\"}),riskDistribution.length>0?/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:riskDistribution,cx:\"50%\",cy:\"50%\",labelLine:false,label:entry=>\"\".concat(entry.name,\": \").concat(entry.value),outerRadius:80,fill:\"#8884d8\",dataKey:\"value\",children:riskDistribution.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:entry.color},\"cell-\".concat(index)))}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>\"\".concat(value,\" users\")}),/*#__PURE__*/_jsx(Legend,{})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-[300px] text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No risk data available\"})})]})]}),currentUser.role==='admin'?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold mb-4 text-gray-900\",children:\"Top Risky Users\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:users.slice(0,10).sort((a,b)=>b.its_score-a.its_score).map((user,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer border border-gray-200\",onClick:()=>selectUser(user),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm\",children:user.name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500 font-medium text-sm\",children:[\"#\",idx+1]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:user.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[user.role,\" \\u2022 \",user.user_id]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",style:{color:getRiskColor(user.risk_level)},children:user.its_score.toFixed(1)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"ITS Score\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-semibold border \".concat(getRiskBadge(user.risk_level)),children:user.risk_level?user.risk_level.toUpperCase():'UNKNOWN'}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5 text-gray-400\"})]})]},user.user_id))})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold mb-4 text-gray-900\",children:\"My Profile & Activities\"}),users.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl\",children:users[0].name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-bold text-gray-900\",children:users[0].name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[users[0].role,\" \\u2022 \",users[0].department]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[\"User ID: \",users[0].user_id]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold\",style:{color:getRiskColor(users[0].risk_level)},children:users[0].its_score.toFixed(1)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-2\",children:\"ITS Score\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-semibold border \".concat(getRiskBadge(users[0].risk_level)),children:((_users$0$risk_level=users[0].risk_level)===null||_users$0$risk_level===void 0?void 0:_users$0$risk_level.toUpperCase())||'N/A'})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>selectUser(users[0]),className:\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition font-medium\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View My Activity Timeline\"})]})]})]})]}),activeView==='users'&&currentUser.role==='admin'&&/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:\"All Monitored Users\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search users...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:filterRisk,onChange:e=>setFilterRisk(e.target.value),className:\"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Risk Levels\"}),/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low Risk\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium Risk\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High Risk\"}),/*#__PURE__*/_jsx(\"option\",{value:\"critical\",children:\"Critical Risk\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Department\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"ITS Score\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Risk Level\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Last Activity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:filteredUsers.map(user=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm\",children:user.name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:user.user_id})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:user.role}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:user.department}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold\",style:{color:getRiskColor(user.risk_level)},children:user.its_score.toFixed(1)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-semibold border \".concat(getRiskBadge(user.risk_level)),children:user.risk_level?user.risk_level.toUpperCase():'UNKNOWN'})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:new Date(user.last_updated).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>selectUser(user),className:\"flex items-center space-x-1 px-3 py-1 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition text-sm font-medium\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View\"})]})})]},user.user_id))})]})})]})}),activeView==='user-detail'&&selectedUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView('overview'),className:\"flex items-center space-x-2 text-indigo-600 hover:text-indigo-700 transition font-medium text-sm\",children:[/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4 rotate-180\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Back to Dashboard\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold shadow-lg\",children:selectedUser.name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:selectedUser.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mt-1\",children:[selectedUser.role,\" \\u2022 \",selectedUser.department]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:[\"User ID: \",selectedUser.user_id]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-1\",children:\"Insider Threat Score\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-5xl font-bold\",style:{color:getRiskColor(selectedUser.risk_level)},children:selectedUser.its_score.toFixed(1)}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-block mt-2 px-4 py-1 rounded-full text-sm font-semibold border \".concat(getRiskBadge(selectedUser.risk_level)),children:[selectedUser.risk_level.toUpperCase(),\" RISK\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold mb-4 text-gray-900\",children:\"Activity Timeline (Last 7 Days)\"}),userActivities.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-12 h-12 mx-auto mb-2 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No activities found for this user\"})]}):/*#__PURE__*/_jsx(ActivityTimeline,{activities:userActivities})]})]}),currentUser.role==='admin'&&activeView==='incidents'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"Incident Management\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowNewIncidentModal(true),className:\"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-sm hover:shadow-md\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"New Incident\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg border border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Open Incidents\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:incidents.filter(i=>i.status==='open').length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-red-50 rounded-lg\",children:/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 text-red-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg border border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:incidents.filter(i=>i.status==='in_progress').length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-yellow-50 rounded-lg\",children:/*#__PURE__*/_jsx(Clock,{className:\"w-5 h-5 text-yellow-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg border border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Resolved\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:incidents.filter(i=>i.status==='resolved').length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-green-50 rounded-lg\",children:/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-green-600\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg border border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Total\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:incidents.length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-gray-50 rounded-lg\",children:/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5 text-gray-600\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Active Incidents\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"Incident\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"Severity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"Created\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"ITS Score\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:incidents.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",className:\"px-6 py-8 text-center text-gray-500\",children:\"No incidents found. Trigger an anomaly or create a new incident to see them here.\"})}):incidents.map((incident,idx)=>{var _incident$its_score;// Extract numeric ID for API calls - handle all formats\nlet incidentIdNum=incident.incident_id_numeric;if(!incidentIdNum&&incident.incident_id){if(typeof incident.incident_id==='number'){incidentIdNum=incident.incident_id;}else{const match=String(incident.incident_id).match(/(\\d+)/);incidentIdNum=match?parseInt(match[1],10):null;}}if(!incidentIdNum&&incident.id){const match=String(incident.id).match(/(\\d+)/);incidentIdNum=match?parseInt(match[1],10):null;}if(!incidentIdNum&&incident.alert_id){incidentIdNum=parseInt(String(incident.alert_id).replace(/\\D/g,''),10);}return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(FileText,{className:\"h-5 w-5 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:incident.id||incident.incident_id||\"INC\".concat(incident.alert_id||0)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:incident.description||'No description'})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:incident.user||incident.user_name||'Unknown'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex px-2 py-1 text-xs font-semibold rounded-full \".concat(incident.severity==='high'||incident.severity==='critical'?'bg-red-100 text-red-800 border border-red-200':incident.severity==='medium'?'bg-yellow-100 text-yellow-800 border border-yellow-200':'bg-green-100 text-green-800 border border-green-200'),children:(incident.severity||'medium').toUpperCase()})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex px-2 py-1 text-xs font-semibold rounded-full \".concat(incident.status==='open'?'bg-red-100 text-red-800 border border-red-200':incident.status==='in_progress'?'bg-yellow-100 text-yellow-800 border border-yellow-200':'bg-green-100 text-green-800 border border-green-200'),children:(incident.status||'open').replace('_',' ').toUpperCase()})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:incident.created?new Date(incident.created).toLocaleDateString():incident.created_at?new Date(incident.created_at).toLocaleDateString():incident.timestamp?new Date(incident.timestamp).toLocaleDateString():'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-bold\",style:{color:getRiskColor(incident.severity)},children:((_incident$its_score=incident.its_score)===null||_incident$its_score===void 0?void 0:_incident$its_score.toFixed(1))||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:incident.status!=='resolved'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedIncident(incident);setShowResolveModal(true);},className:\"px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-xs font-medium flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Resolve\"})]}),incident.status==='open'&&/*#__PURE__*/_jsxs(\"button\",{onClick:async()=>{try{// Extract numeric ID for API call (must be done here, not in map scope)\nconst startIncidentIdNum=incident.incident_id_numeric||(incident.incident_id?parseInt(String(incident.incident_id).replace(/\\D/g,''),10):null)||(incident.alert_id?parseInt(String(incident.alert_id).replace(/\\D/g,''),10):null)||(incident.id?parseInt(String(incident.id).replace(/\\D/g,''),10):null);if(!startIncidentIdNum){console.error('Start button - Incident data:',incident);showNotification(\"Error: Could not determine incident ID. ID: \".concat(incident.id||incident.incident_id||'undefined'),'error');return;}const response=await fetch(\"\".concat(API_URL,\"/api/incidents/\").concat(startIncidentIdNum,\"/status\"),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:'in_progress'})});if(response.ok){showNotification('Incident status updated to In Progress','success');// Refresh incidents immediately\nconst incidentsResponse=await fetch(\"\".concat(API_URL,\"/api/incidents?limit=100\"));if(incidentsResponse.ok){const incidentsData=await incidentsResponse.json();const transformedIncidents=(incidentsData||[]).map(inc=>{// Extract numeric ID\nlet numericId=null;if(inc.incident_id){const match=String(inc.incident_id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}if(!numericId&&typeof inc.incident_id==='number'){numericId=inc.incident_id;}if(!numericId&&inc.id){const match=String(inc.id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}return{id:inc.incident_id||inc.id||\"INC\".concat(numericId||0),incident_id:inc.incident_id||inc.id,incident_id_numeric:numericId,alert_id:inc.incident_id||inc.alert_id,user_id:inc.user_id,user:inc.user_name||inc.user||'Unknown',user_name:inc.user_name||inc.user,severity:inc.severity,status:inc.status||'open',created:inc.created_at||inc.timestamp||inc.created,created_at:inc.created_at||inc.timestamp||inc.created,timestamp:inc.timestamp||inc.created_at||inc.created,description:inc.description||inc.explanation||'',its_score:inc.its_score||0,incident_type:inc.incident_type||'suspicious_activity',assigned_to:inc.assigned_to||'Security Team',resolution_notes:inc.resolution_notes||null,resolved_at:inc.resolved_at||null};});setIncidents(transformedIncidents);}await refreshDashboardData();}else{showNotification('Failed to update incident status','error');}}catch(error){showNotification('Error updating incident','error');}},className:\"px-3 py-1.5 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition text-xs font-medium flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Clock,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Start\"})]})]})})})]},idx);})})]})})]})]}),showNewIncidentModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4\",style:{zIndex:9998},children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900\",children:\"Create New Incident\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNewIncidentModal(false),className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]})}),/*#__PURE__*/_jsx(NewIncidentForm,{users:users,onClose:()=>setShowNewIncidentModal(false),onSuccess:async()=>{showNotification('Incident created successfully','success');setShowNewIncidentModal(false);// Immediately refresh incidents list with proper transformation\ntry{const incidentsResponse=await fetch(\"\".concat(API_URL,\"/api/incidents?limit=100\"));if(incidentsResponse.ok){const incidentsData=await incidentsResponse.json();const transformedIncidents=(incidentsData||[]).map(inc=>{// Extract numeric ID consistently\nlet numericId=null;if(inc.incident_id){// If it's a number, use it directly\nif(typeof inc.incident_id==='number'){numericId=inc.incident_id;}else{// If it's a string, extract number\nconst match=String(inc.incident_id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}}if(!numericId&&inc.id){const match=String(inc.id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}return{id:inc.incident_id_formatted||inc.id||\"INC\".concat(numericId||0),incident_id:inc.incident_id_formatted||inc.incident_id||inc.id,incident_id_numeric:numericId||(typeof inc.incident_id==='number'?inc.incident_id:null),alert_id:inc.incident_id||inc.alert_id,user_id:inc.user_id,user:inc.user_name||inc.user||'Unknown',user_name:inc.user_name||inc.user,severity:inc.severity,status:inc.status||'open',created:inc.created_at||inc.created||inc.timestamp,created_at:inc.created_at||inc.created||inc.timestamp,timestamp:inc.timestamp||inc.created_at||inc.created,description:inc.description||inc.explanation||'',its_score:inc.its_score||0,incident_type:inc.incident_type||'suspicious_activity',assigned_to:inc.assigned_to||'Security Team',resolution_notes:inc.resolution_notes||null,resolved_at:inc.resolved_at||null};});setIncidents(transformedIncidents);console.log('[NEW INCIDENT] Refreshed incidents list:',transformedIncidents.length,'incidents');}}catch(error){console.error('Error refreshing incidents after creation:',error);}await refreshDashboardData();},showNotification:showNotification,API_URL:API_URL})]})}),showResolveModal&&selectedIncident&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4\",style:{zIndex:9998},children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl max-w-lg w-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900\",children:\"Resolve Incident\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowResolveModal(false);setSelectedIncident(null);setResolveNotes('');},className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"Incident ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900\",children:selectedIncident.id})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:\"User\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900\",children:selectedIncident.user})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Resolution Notes \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:resolveNotes,onChange:e=>setResolveNotes(e.target.value),placeholder:\"Enter resolution details, actions taken, and any additional notes...\",rows:4,className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 pt-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:async()=>{if(!resolveNotes.trim()){showNotification('Please enter resolution notes','error');return;}try{// Extract numeric ID for API call - try multiple methods\nlet incidentIdNum=selectedIncident.incident_id_numeric;if(!incidentIdNum&&selectedIncident.incident_id){const match=String(selectedIncident.incident_id).match(/(\\d+)/);incidentIdNum=match?parseInt(match[1],10):null;}if(!incidentIdNum&&selectedIncident.id){const match=String(selectedIncident.id).match(/(\\d+)/);incidentIdNum=match?parseInt(match[1],10):null;}if(!incidentIdNum&&selectedIncident.alert_id){incidentIdNum=parseInt(String(selectedIncident.alert_id).replace(/\\D/g,''),10);}if(!incidentIdNum||isNaN(incidentIdNum)){console.error('Resolve button - Incident data:',selectedIncident);showNotification(\"Error: Could not determine incident ID. ID: \".concat(selectedIncident.id||selectedIncident.incident_id||'undefined'),'error');return;}console.log(\"[RESOLVE] Attempting to resolve incident with ID: \".concat(incidentIdNum));const response=await fetch(\"\".concat(API_URL,\"/api/incidents/\").concat(incidentIdNum,\"/resolve\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({resolution_notes:resolveNotes})});if(response.ok){showNotification('Incident resolved successfully','success');setShowResolveModal(false);setSelectedIncident(null);setResolveNotes('');// Refresh incidents immediately\nconst incidentsResponse=await fetch(\"\".concat(API_URL,\"/api/incidents?limit=100\"));if(incidentsResponse.ok){const incidentsData=await incidentsResponse.json();const transformedIncidents=(incidentsData||[]).map(inc=>{// Extract numeric ID consistently\nlet numericId=null;if(inc.incident_id){const match=String(inc.incident_id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}if(!numericId&&typeof inc.incident_id==='number'){numericId=inc.incident_id;}if(!numericId&&inc.id){const match=String(inc.id).match(/(\\d+)/);numericId=match?parseInt(match[1],10):null;}return{id:inc.incident_id||inc.id||\"INC\".concat(numericId||0),incident_id:inc.incident_id||inc.id,incident_id_numeric:numericId,alert_id:inc.incident_id||inc.alert_id,user_id:inc.user_id,user:inc.user_name||inc.user||'Unknown',user_name:inc.user_name||inc.user,severity:inc.severity,status:inc.status||'open',created:inc.created_at||inc.timestamp||inc.created,created_at:inc.created_at||inc.timestamp||inc.created,timestamp:inc.timestamp||inc.created_at||inc.created,description:inc.description||inc.explanation||'',its_score:inc.its_score||0,incident_type:inc.incident_type||'suspicious_activity',assigned_to:inc.assigned_to||'Security Team',resolution_notes:inc.resolution_notes||null,resolved_at:inc.resolved_at||null};});setIncidents(transformedIncidents);}await refreshDashboardData();}else{const error=await response.json();showNotification(error.detail||'Failed to resolve incident','error');}}catch(error){showNotification('Error resolving incident','error');}},className:\"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 inline mr-2\"}),\"Resolve Incident\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowResolveModal(false);setSelectedIncident(null);setResolveNotes('');},className:\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\",children:\"Cancel\"})]})]})]})}),activeView==='alerts'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:currentUser.role==='admin'?'Threat Alerts':'My Alerts'}),currentUser.role==='admin'&&/*#__PURE__*/_jsxs(\"button\",{onClick:async()=>{// Mark all alerts as viewed\ntry{const response=await fetch(\"\".concat(API_URL,\"/api/alerts/mark-viewed\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({alert_ids:null})});if(response.ok){showNotification('All alerts marked as viewed','success');await refreshDashboardData();// Refresh alerts list\nconst alertsResponse=await fetch(\"\".concat(API_URL,\"/api/alerts\"));if(alertsResponse.ok){const alertsData=await alertsResponse.json();setAlerts(alertsData||[]);}}}catch(error){showNotification('Error marking alerts as viewed','error');}},className:\"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition text-sm font-medium flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Mark All as Viewed\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl border border-gray-200 shadow-sm\",children:alerts.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-center\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-16 h-16 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:\"No Active Alerts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"All systems operating normally\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-gray-200\",children:alerts.map((alert,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"p-6 hover:bg-gray-50 transition cursor-pointer \".concat(alert.is_viewed?'opacity-60':'opacity-100 bg-red-50/30'),onClick:async()=>{// Mark individual alert as viewed when clicked\nif(alert.alert_db_id&&!alert.is_viewed){try{const response=await fetch(\"\".concat(API_URL,\"/api/alerts/mark-viewed\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({alert_ids:[alert.alert_db_id]})});if(response.ok){await refreshDashboardData();// Update local state\nsetAlerts(prev=>prev.map(a=>a.alert_db_id===alert.alert_db_id?_objectSpread(_objectSpread({},a),{},{is_viewed:true}):a));}}catch(error){console.error('Error marking alert as viewed:',error);}}},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900\",children:alert.alert_id}),!alert.is_viewed&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-semibold rounded-full animate-pulse\",children:\"NEW\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:alert.explanation||'Anomaly detected'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 font-medium\",children:[\"\\uD83D\\uDD50 \",formatTimestamp(alert.timestamp),\" (\",formatTimeAgo(alert.timestamp),\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"User: \",alert.user_id]})]}),alert.anomalies&&alert.anomalies.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex flex-wrap gap-2\",children:alert.anomalies.slice(0,3).map((anomaly,aIdx)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded\",children:anomaly},aIdx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",style:{color:getRiskColor(alert.risk_level)},children:alert.its_score.toFixed(1)}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-2 px-3 py-1 rounded-full text-xs font-semibold \".concat(getRiskBadge(alert.risk_level)),children:alert.risk_level.toUpperCase()}),alert.is_incident&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-2 ml-2 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold\",children:\"INCIDENT\"})]}),currentUser.role==='admin'&&(alert.risk_level==='high'||alert.risk_level==='critical')&&!alert.is_incident&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 flex space-x-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:async e=>{e.stopPropagation();try{const response=await fetch(\"\".concat(API_URL,\"/api/alerts/\").concat(alert.alert_db_id,\"/convert-to-incident\"),{method:'POST',headers:{'Content-Type':'application/json'}});if(response.ok){const data=await response.json();showNotification(data.status==='already_converted'?\"Already converted to incident \".concat(data.incident_id_formatted):\"Alert converted to incident \".concat(data.incident_id_formatted),'success');await refreshDashboardData();// Refresh alerts\nconst alertsResponse=await fetch(\"\".concat(API_URL,\"/api/alerts?limit=50&unread_only=false\"));if(alertsResponse.ok){const alertsData=await alertsResponse.json();setAlerts(alertsData||[]);}}else{showNotification('Error converting alert to incident','error');}}catch(error){showNotification('Error converting alert to incident','error');}},className:\"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-xs font-medium transition flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Convert to Incident\"})]})})]})},alert.alert_db_id||idx))})})]}),currentUser.role==='admin'&&activeView==='analytics'&&analyticsData&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between flex-wrap gap-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"ML Model Analytics\"}),analyticsData.ensemble&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-indigo-500 via-purple-600 to-indigo-500 text-white px-8 py-4 rounded-xl shadow-2xl border-2 border-indigo-300 transform hover:scale-105 transition-all\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Cpu,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium opacity-90 mb-1\",children:\"Ensemble Accuracy\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-4xl font-bold\",children:[analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:\"3-Model Ensemble\"})]})]})})]}),analyticsData.ensemble&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-indigo-50 via-purple-50 to-indigo-50 border-2 border-indigo-300 rounded-xl p-8 shadow-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 text-white\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-900\",children:\"Why Ensemble Learning Despite XGBoost Being Higher?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold\",children:[analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1),\"% Ensemble\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-800\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Note:\"}),\" XGBoost achieves \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-blue-600\",children:\"91.4%\"}),\" accuracy alone, while ensemble achieves \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-indigo-600\",children:\"89.3%\"}),\". However, ensemble provides\",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\" critical security advantages\"}),\" that justify the slight accuracy trade-off.\"]})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 text-base mb-6 leading-relaxed\",children:analyticsData.ensemble.explanation}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\",children:analyticsData.ensemble.benefits.map((benefit,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3 bg-white rounded-lg p-4 border border-indigo-100 shadow-sm hover:shadow-md transition\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-green-600 mt-0.5 flex-shrink-0\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",clipRule:\"evenodd\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-800 font-medium\",children:benefit})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg p-5 border-2 border-indigo-400 shadow-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-semibold mb-3 text-base\",children:\"Ensemble Accuracy Calculation:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-mono bg-black/20 rounded p-3 border border-white/20\",children:analyticsData.ensemble.calculation}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-white/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/90 text-xs mb-2\",children:\"Model Contributions (Weighted Average):\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/20 rounded p-2 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-xs font-medium\",children:\"XGBoost\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-lg font-bold\",children:\"50%\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80 text-xs\",children:\"91.4% acc\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/70 text-xs mt-1\",children:\"Contribution: 45.7%\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/20 rounded p-2 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-xs font-medium\",children:\"Random Forest\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-lg font-bold\",children:\"30%\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80 text-xs\",children:\"89.7% acc\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/70 text-xs mt-1\",children:\"Contribution: 26.9%\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/20 rounded p-2 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-xs font-medium\",children:\"Isolation Forest\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-lg font-bold\",children:\"20%\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80 text-xs\",children:\"83.4% acc\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/70 text-xs mt-1\",children:\"Contribution: 16.7%\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 pt-3 border-t border-white/20 text-center\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm font-semibold\",children:[\"Total: 45.7% + 26.9% + 16.7% = \",/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-300\",children:\"89.3%\"})]})})]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Model Performance\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:analyticsData.models.map((model,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900\",children:model.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-semibold \".concat(model.color,\" text-white\"),children:model.weight}),/*#__PURE__*/_jsxs(\"div\",{className:\"group relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 hover:text-gray-600 cursor-help\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 top-6 w-64 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold mb-1\",children:\"Weight Calculation:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300\",children:model.weight_calculation||'Based on model performance metrics'}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-gray-400 text-xs\",children:\"Formula: Weight = (F1 \\xD7 0.6) + (AUC \\xD7 0.4)\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg p-3 border border-indigo-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-xs mb-1\",children:\"Accuracy\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-indigo-600\",children:[(model.accuracy*100).toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Model accuracy\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"F1-Score\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-bold text-gray-900\",children:model.f1.toFixed(3)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"AUC-ROC\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-bold text-gray-900\",children:model.auc.toFixed(3)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200 bg-gray-50 rounded-lg p-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-700 mb-2\",children:/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-indigo-600\",children:\"Accuracy Calculation:\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600 font-mono bg-white rounded p-2 border border-gray-200\",children:[\"(F1 \\xD7 0.6) + (AUC \\xD7 0.4) = \",(model.f1*0.6+model.auc*0.4).toFixed(3),\" = \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-indigo-600\",children:[(model.accuracy*100).toFixed(1),\"%\"]})]})]})]},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"System Statistics\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[analyticsData.ensemble&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border-2 border-indigo-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-gray-900\",children:\"Ensemble Accuracy\"}),/*#__PURE__*/_jsx(Cpu,{className:\"w-5 h-5 text-indigo-600\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-4xl font-bold text-indigo-600 mb-1\",children:[analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600\",children:\"3-model weighted ensemble\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 pt-3 border-t border-indigo-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 font-medium mb-1\",children:\"Model Weights:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-xs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-blue-600 text-white px-2 py-1 rounded\",children:\"XGBoost 50%\"}),/*#__PURE__*/_jsx(\"span\",{className:\"bg-green-600 text-white px-2 py-1 rounded\",children:\"RF 30%\"}),/*#__PURE__*/_jsx(\"span\",{className:\"bg-purple-600 text-white px-2 py-1 rounded\",children:\"IF 20%\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"Activities Processed\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:analyticsData.system_stats.activities_processed.toLocaleString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"False Positive Rate\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:[analyticsData.system_stats.false_positive_rate,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"Detection Time\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:[analyticsData.system_stats.detection_time_ms,\"ms\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Feature Importance\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:analyticsData.feature_importance.map((feature,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700 w-48 font-medium\",children:feature.name}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-gray-200 rounded-full h-6 overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-600 h-6 rounded-full flex items-center justify-end pr-2\",style:{width:\"\".concat(feature.importance*100,\"%\")},children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-white font-semibold\",children:[(feature.importance*100).toFixed(0),\"%\"]})})})]},idx))})]})]}),currentUser.role==='admin'&&activeView==='intelligence'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"User Intelligence\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>{const user=users.find(u=>u.user_id===e.target.value);if(user){setSelectedUser(user);setActiveView('intelligence');}},className:\"px-4 py-2 border border-gray-300 rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{children:\"Select User\"}),users.map(user=>/*#__PURE__*/_jsx(\"option\",{value:user.user_id,children:user.name},user.user_id))]})]}),intelligenceData?/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"User Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold\",children:intelligenceData.name.split(' ').map(n=>n[0]).join('')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900\",children:intelligenceData.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Developer \\u2022 Engineering\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"ITS Score\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold\",style:{color:getRiskColor(intelligenceData.risk_level)},children:intelligenceData.its_score.toFixed(1)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Risk Level\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold\",style:{color:getRiskColor(intelligenceData.risk_level)},children:intelligenceData.risk_level.toUpperCase()})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Behavioral Patterns\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Work Hours Compliance\"}),/*#__PURE__*/_jsxs(\"span\",{children:[intelligenceData.behavioral_patterns.work_hours_compliance.toFixed(0),\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-500 h-2 rounded-full\",style:{width:\"\".concat(intelligenceData.behavioral_patterns.work_hours_compliance,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Data Access Normal\"}),/*#__PURE__*/_jsxs(\"span\",{children:[intelligenceData.behavioral_patterns.data_access_normal.toFixed(0),\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-orange-500 h-2 rounded-full\",style:{width:\"\".concat(intelligenceData.behavioral_patterns.data_access_normal,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Email Pattern Normal\"}),/*#__PURE__*/_jsxs(\"span\",{children:[intelligenceData.behavioral_patterns.email_pattern_normal.toFixed(0),\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-500 h-2 rounded-full\",style:{width:\"\".concat(intelligenceData.behavioral_patterns.email_pattern_normal,\"%\")}})})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Risk Trend (Last 30 Days)\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(LineChart,{data:intelligenceData.risk_trend,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"day\"}),/*#__PURE__*/_jsx(YAxis,{domain:[0,100]}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"score\",stroke:\"#dc2626\",strokeWidth:2})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Top Anomalies\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:intelligenceData.top_anomalies.map((anomaly,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:anomaly.type}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-semibold text-red-600\",children:[anomaly.count,\" times\"]})]},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Feature Importance\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:intelligenceData.feature_importance.map((item,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600 flex-1\",children:item.feature}),/*#__PURE__*/_jsx(\"div\",{className:\"w-24 bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-600 h-2 rounded-full\",style:{width:\"\".concat(item.importance*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 w-8\",children:[(item.importance*100).toFixed(0),\"%\"]})]},idx))})]})]})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Select a user from the dropdown to view intelligence data\"})})]}),currentUser.role==='admin'&&activeView==='simulation'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"Attack Simulation\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"Trigger anomalies to test the detection system\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 bg-white p-6 rounded-lg border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Simulation Controls\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Select User \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:(selectedUser===null||selectedUser===void 0?void 0:selectedUser.user_id)||'',onChange:e=>{const userId=e.target.value;if(userId){const user=users.find(u=>u.user_id===userId);setSelectedUser(user||null);}else{setSelectedUser(null);}},className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select User --\"}),users&&users.length>0?users.map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.user_id,children:[user.name,\" (\",user.user_id,\") - \",user.risk_level||'low',\" risk\"]},user.user_id)):/*#__PURE__*/_jsx(\"option\",{disabled:true,children:\"Loading users...\"})]}),selectedUser&&/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 text-xs text-gray-500\",children:[\"Selected: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:selectedUser.name}),\" - Current ITS: \",((_selectedUser$its_sco=selectedUser.its_score)===null||_selectedUser$its_sco===void 0?void 0:_selectedUser$its_sco.toFixed(1))||'N/A']})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Attack Type \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"anomalyType\",defaultValue:\"data_exfiltration\",className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"data_exfiltration\",children:\"Data Exfiltration - Large file downloads + external emails\"}),/*#__PURE__*/_jsx(\"option\",{value:\"off_hours\",children:\"Off-Hours Activity - Late night logons (22:00-23:59)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sabotage\",children:\"Insider Sabotage - Multiple file deletions\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(!selectedUser){showNotification('Please select a user first','error');return;}const anomalyTypeSelect=document.getElementById('anomalyType');if(!anomalyTypeSelect){showNotification('Anomaly type selector not found','error');return;}const anomalyType=anomalyTypeSelect.value;if(!anomalyType){showNotification('Please select an anomaly type','error');return;}setSimulationRunning(true);showNotification('Triggering anomaly...','info');try{const response=await fetch(\"\".concat(API_URL,\"/api/trigger/anomaly?user_id=\").concat(selectedUser.user_id,\"&anomaly_type=\").concat(anomalyType),{method:'POST',headers:{'Content-Type':'application/json'}});if(response.ok){var _data$its_score;const data=await response.json();// Show success notification with activity count\nshowNotification(\"Anomaly triggered! \".concat(selectedUser.name,\" - \").concat(data.activities_created||0,\" activities created. ITS: \").concat(((_data$its_score=data.its_score)===null||_data$its_score===void 0?void 0:_data$its_score.toFixed(1))||'N/A',\" (\").concat(data.risk_level||'N/A',\")\"),'success');// Small delay to ensure database commit completes\nawait new Promise(resolve=>setTimeout(resolve,500));// Refresh all dashboard data in real-time\nawait refreshDashboardData();// Update selected user's data if viewing their detail\nif(selectedUser){const updatedUsers=await fetch(\"\".concat(API_URL,\"/api/users\")).then(r=>r.json());const updatedUser=updatedUsers.find(u=>u.user_id===selectedUser.user_id);if(updatedUser){setSelectedUser(updatedUser);// Explicitly refresh activities for the user whose anomaly was triggered\n// Add another small delay and retry to ensure activities are visible\nawait new Promise(resolve=>setTimeout(resolve,300));await fetchUserActivities(selectedUser.user_id);// One more refresh after a brief moment to catch any delayed commits\nsetTimeout(async()=>{await fetchUserActivities(selectedUser.user_id);},1000);}}setSimulationRunning(false);}else{const errorText=await response.text();let errorData;try{errorData=JSON.parse(errorText);}catch(_unused){errorData={detail:errorText||'Unknown server error'};}showNotification(\"Failed: \".concat(errorData.detail||'Server error'),'error');setSimulationRunning(false);}}catch(error){console.error('Error triggering anomaly:',error);showNotification(\"Network Error: \".concat(error.message),'error');setSimulationRunning(false);}},disabled:simulationRunning||!selectedUser,className:\"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium\",children:simulationRunning?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Triggering Anomaly...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Zap,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Trigger Anomaly\"})]})}),selectedUser&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" After triggering, all dashboard data will update automatically in real-time. No page refresh needed!\"]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg border border-gray-200 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-gray-900\",children:\"Instructions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-indigo-600\",children:\"1.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select a user from the dropdown above\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-indigo-600\",children:\"2.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Choose an anomaly type to simulate\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-indigo-600\",children:\"3.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Click \\\"Trigger Anomaly\\\" button\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900 mb-2\",children:\"What happens:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside space-y-1 text-xs\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Creates suspicious activities\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Recalculates ITS score\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Generates an alert\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Updates all dashboard metrics\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-yellow-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCA1 Tip:\"}),\" Check the Alerts and Incidents tabs after triggering to see the generated alerts.\"]})})]})]})]})]})]});};// Main App Component with Routing\nconst App=()=>{return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LandingPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/signin\",element:/*#__PURE__*/_jsx(SignInPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(Dashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","useNavigate","LineChart","Line","BarChart","Bar","PieChart","Pie","Cell","XAxis","YAxis","CartesianGrid","Tooltip","Legend","ResponsiveContainer","AlertTriangle","Shield","Users","Activity","TrendingUp","Clock","MapPin","FileText","Mail","HardDrive","Eye","ChevronRight","Search","Bell","RefreshCw","Home","BarChart3","AlertCircle","Zap","User","CheckCircle","Lock","LogIn","ArrowRight","Cpu","X","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CREDENTIALS","admins","username","password","name","role","users","checkUserExists","API_URL","process","env","REACT_APP_API_URL","response","fetch","concat","ok","json","find","u","user_id","error","console","AuthContext","createContext","useAuth","context","useContext","Error","AuthProvider","_ref","children","currentUser","setCurrentUser","stored","localStorage","getItem","JSON","parse","login","admin","a","user","userId","setItem","stringify","success","regularUser","match","userNum","parseInt","substring","userFromDB","message","logout","removeItem","Provider","value","LandingPage","navigate","className","onClick","icon","title","description","color","map","feature","idx","SignInPage","setUsername","setPassword","loading","setLoading","setError","handleSignIn","e","preventDefault","result","onSubmit","type","onChange","target","placeholder","required","disabled","ActivityTimeline","_ref2","activities","currentTime","setCurrentTime","Date","interval","setInterval","clearInterval","formatTimeAgo","timestamp","activityDate","diffMs","diffMins","Math","floor","diffHours","diffDays","toLocaleDateString","month","day","year","formatTimestamp","date","now","toLocaleString","hour","minute","hour12","activity","activity_type","replace","details","ip","device","file_path","action","sensitivity","recipient","external","undefined","NewIncidentForm","_ref3","onClose","onSuccess","showNotification","formData","setFormData","severity","explanation","handleSubmit","method","headers","body","detail","_objectSpread","risk_level","rows","Dashboard","_users$","_users$$risk_level","_users$0$risk_level","_selectedUser$its_sco","isLoading","setIsLoading","activeView","setActiveView","selectedUser","setSelectedUser","searchQuery","setSearchQuery","filterRisk","setFilterRisk","refreshing","setRefreshing","setUsers","userActivities","setUserActivities","dashboardStats","setDashboardStats","total_users","high_risk_users","active_threats","average_its","alerts_today","ensemble_accuracy","incidents","setIncidents","intelligenceData","setIntelligenceData","analyticsData","setAnalyticsData","alerts","setAlerts","simulationRunning","setSimulationRunning","notification","setNotification","showNewIncidentModal","setShowNewIncidentModal","showResolveModal","setShowResolveModal","selectedIncident","setSelectedIncident","resolveNotes","setResolveNotes","itsScoreTrend","setItsScoreTrend","showLogoutConfirm","setShowLogoutConfirm","timer","setTimeout","clearTimeout","fetchUsers","data","userProfile","fetchStats","userAlertsResponse","userAlertCount","userAlertsData","filter","is_viewed","length","its_score","parseFloat","toFixed","fetchAlerts","url","unreadCount","prev","fetchIncidents","transformedIncidents","inc","id","incident_id","alert_id","user_name","status","created","created_at","incident_type","assigned_to","resolution_notes","resolved_at","fetchUserActivities","selectUser","handleRefresh","handleLogout","confirmLogout","getRiskColor","riskLevel","toLowerCase","getRiskBadge","filteredUsers","matchesSearch","includes","matchesFilter","riskDistribution","item","fetchHistoricalITS","trend","currentScore","fallbackTrend","Array","from","_","i","score","fetchTabData","numericId","String","incident_id_numeric","alertsUrl","alert_ids","then","refreshDashboardData","arguments","usersResponse","usersData","statsResponse","statsData","alertsResponse","alertsData","incidentsResponse","incidentsData","firstUser","style","zIndex","label","view","IconComponent","toUpperCase","width","height","strokeDasharray","stroke","dataKey","contentStyle","backgroundColor","border","borderRadius","boxShadow","strokeWidth","dot","r","cx","cy","labelLine","entry","outerRadius","fill","index","formatter","slice","sort","b","split","n","join","department","last_updated","colSpan","incident","_incident$its_score","incidentIdNum","startIncidentIdNum","incident_id_formatted","log","trim","isNaN","alert","alert_db_id","anomalies","anomaly","aIdx","is_incident","stopPropagation","ensemble","ensemble_accuracy_percentage","viewBox","strokeLinecap","strokeLinejoin","d","benefits","benefit","fillRule","clipRule","calculation","models","model","weight","weight_calculation","accuracy","f1","auc","system_stats","activities_processed","false_positive_rate","detection_time_ms","feature_importance","importance","behavioral_patterns","work_hours_compliance","data_access_normal","email_pattern_normal","risk_trend","domain","top_anomalies","count","defaultValue","anomalyTypeSelect","document","getElementById","anomalyType","_data$its_score","activities_created","Promise","resolve","updatedUsers","updatedUser","errorText","text","errorData","_unused","App","path","element","to"],"sources":["/Users/abhinavpv/Desktop/insider-threat-detection/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate, useNavigate } from 'react-router-dom';\nimport { LineChart, Line, BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { AlertTriangle, Shield, Users, Activity, TrendingUp, Clock, MapPin, FileText, Mail, HardDrive, Eye, ChevronRight, Search, Bell, RefreshCw, Home, BarChart3, AlertCircle, Zap, User, CheckCircle, Lock, LogIn, ArrowRight, Cpu, X } from 'lucide-react';\n\n// Stored credentials\n// Note: All 50 users (U001-U050) use password 'user123'\n// Security admins must update this list when adding new users\nconst CREDENTIALS = {\n  admins: [\n    { username: 'admin', password: 'admin123', name: 'Security Admin 1', role: 'admin' },\n    { username: 'secadmin', password: 'secure123', name: 'Security Admin 2', role: 'admin' }\n  ],\n  users: [\n    // Demo users (U001-U003) - Real-time monitoring enabled\n    { username: 'U001', password: 'user123', name: 'Abhinav P V', role: 'user' },\n    { username: 'U002', password: 'user123', name: 'Abhinav Gadde', role: 'user' },\n    { username: 'U003', password: 'user123', name: 'Indushree', role: 'user' },\n    // Regular users (U004-U050) - Generated data\n    // All follow pattern: username = User ID, password = 'user123'\n    // Names are fetched from backend database\n  ]\n};\n\n// Helper function to check if user exists (for U004-U050)\nconst checkUserExists = async (username) => {\n  try {\n    const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n    const response = await fetch(`${API_URL}/api/users`);\n    if (response.ok) {\n      const users = await response.json();\n      return users.find(u => u.user_id === username);\n    }\n  } catch (error) {\n    console.error('Error checking user:', error);\n  }\n  return null;\n};\n\n// Authentication Context\nconst AuthContext = React.createContext();\n\nconst useAuth = () => {\n  const context = React.useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n\nconst AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n\n  useEffect(() => {\n    const stored = localStorage.getItem('sentineliq_user');\n    if (stored) {\n      setCurrentUser(JSON.parse(stored));\n    }\n  }, []);\n\n  const login = async (username, password) => {\n    // Check admins\n    const admin = CREDENTIALS.admins.find(\n      a => a.username === username && a.password === password\n    );\n    if (admin) {\n      const user = { username: admin.username, name: admin.name, role: 'admin', userId: null };\n      setCurrentUser(user);\n      localStorage.setItem('sentineliq_user', JSON.stringify(user));\n      return { success: true, user };\n    }\n\n    // Check known users (U001-U003)\n    const regularUser = CREDENTIALS.users.find(\n      u => u.username === username && u.password === password\n    );\n    if (regularUser) {\n      const user = { username: regularUser.username, name: regularUser.name, role: 'user', userId: regularUser.username };\n      setCurrentUser(user);\n      localStorage.setItem('sentineliq_user', JSON.stringify(user));\n      return { success: true, user };\n    }\n\n    // Check if username matches pattern U004-U050 and password is correct\n    if (username.match(/^U\\d{3}$/) && password === 'user123') {\n      const userNum = parseInt(username.substring(1));\n      if (userNum >= 4 && userNum <= 50) {\n        // Fetch user name from backend\n        const userFromDB = await checkUserExists(username);\n        if (userFromDB) {\n          const user = { \n            username: username, \n            name: userFromDB.name || username, \n            role: 'user', \n            userId: username \n          };\n          setCurrentUser(user);\n          localStorage.setItem('sentineliq_user', JSON.stringify(user));\n          return { success: true, user };\n        }\n      }\n    }\n\n    return { success: false, message: 'Invalid credentials' };\n  };\n\n  const logout = () => {\n    setCurrentUser(null);\n    localStorage.removeItem('sentineliq_user');\n  };\n\n  return (\n    <AuthContext.Provider value={{ currentUser, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n// Landing Page Component\nconst LandingPage = () => {\n  const navigate = useNavigate();\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900\">\n      <nav className=\"bg-transparent backdrop-blur-sm border-b border-white/10 sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Shield className=\"w-10 h-10 text-indigo-400\" />\n              <div>\n                <h1 className=\"text-2xl font-bold text-white\">SentinelIQ</h1>\n                <p className=\"text-xs text-gray-400\">Insider Threat Detection</p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <button \n                onClick={() => navigate('/signin')}\n                className=\"flex items-center space-x-2 px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition font-medium\"\n              >\n                <LogIn className=\"w-4 h-4\" />\n                <span>Login</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      <div className=\"max-w-7xl mx-auto px-6 py-20\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center\">\n          <div className=\"space-y-8\">\n            <div className=\"inline-block px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-full\">\n              <span className=\"text-indigo-300 text-sm font-semibold\">🚀 AI-Powered Security Platform</span>\n            </div>\n            \n            <h1 className=\"text-6xl font-bold text-white leading-tight\">\n              Detect Insider Threats<br />\n              <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400\">\n                Before They Strike\n              </span>\n            </h1>\n            \n            <p className=\"text-xl text-gray-300 leading-relaxed\">\n              Advanced AI/ML-powered platform that identifies suspicious behavior patterns, \n              analyzes user activities, and prevents security breaches in real-time.\n            </p>\n            \n            <div className=\"flex items-center space-x-4\">\n              <button \n                onClick={() => navigate('/signin')}\n                className=\"flex items-center space-x-2 px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl transition font-semibold text-lg shadow-lg shadow-indigo-500/50\"\n              >\n                <span>Get Started</span>\n                <ArrowRight className=\"w-5 h-5\" />\n              </button>\n              <button className=\"px-8 py-4 bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white rounded-xl transition font-semibold text-lg border border-white/20\">\n                Watch Demo\n              </button>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-6 pt-8\">\n              <div className=\"space-y-1\">\n                <p className=\"text-3xl font-bold text-white\">94.5%</p>\n                <p className=\"text-sm text-gray-400\">Detection Accuracy</p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-3xl font-bold text-white\">&lt;1s</p>\n                <p className=\"text-sm text-gray-400\">Response Time</p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-3xl font-bold text-white\">10K+</p>\n                <p className=\"text-sm text-gray-400\">Users Protected</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-3xl opacity-20 blur-3xl\"></div>\n            <div className=\"relative bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl\">\n              <div className=\"space-y-6\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-white font-semibold\">Live Threat Detection</h3>\n                  <div className=\"flex items-center space-x-2 px-3 py-1 bg-green-500/20 border border-green-500/30 rounded-full\">\n                    <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                    <span className=\"text-green-400 text-xs font-semibold\">Active</span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\">\n                    <div className=\"p-3 bg-red-500/20 rounded-lg\">\n                      <AlertTriangle className=\"w-6 h-6 text-red-400\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-white font-medium\">High Risk Activity</p>\n                      <p className=\"text-sm text-gray-400\">Off-hours file access detected</p>\n                    </div>\n                    <span className=\"text-red-400 font-bold\">ITS: 89</span>\n                  </div>\n\n                  <div className=\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\">\n                    <div className=\"p-3 bg-yellow-500/20 rounded-lg\">\n                      <Activity className=\"w-6 h-6 text-yellow-400\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-white font-medium\">Anomaly Detected</p>\n                      <p className=\"text-sm text-gray-400\">Unusual email patterns</p>\n                    </div>\n                    <span className=\"text-yellow-400 font-bold\">ITS: 67</span>\n                  </div>\n\n                  <div className=\"flex items-center space-x-4 p-4 bg-slate-700/50 rounded-xl border border-white/5\">\n                    <div className=\"p-3 bg-green-500/20 rounded-lg\">\n                      <CheckCircle className=\"w-6 h-6 text-green-400\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-white font-medium\">Normal Activity</p>\n                      <p className=\"text-sm text-gray-400\">Standard user behavior</p>\n                    </div>\n                    <span className=\"text-green-400 font-bold\">ITS: 23</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mt-32\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl font-bold text-white mb-4\">Comprehensive Security Features</h2>\n            <p className=\"text-xl text-gray-400\">Everything you need to protect your organization</p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[\n              { icon: Cpu, title: 'AI/ML Detection', description: 'Ensemble ML models with 89.8% accuracy (XGBoost + Random Forest + Isolation Forest)', color: 'indigo' },\n              { icon: Activity, title: 'Real-Time Monitoring', description: 'Sub-second threat detection and alerting', color: 'purple' },\n              { icon: Users, title: 'User Intelligence', description: 'Comprehensive behavioral analytics and profiling', color: 'blue' },\n              { icon: Zap, title: 'Attack Simulation', description: 'Interactive threat scenario testing', color: 'red' }\n            ].map((feature, idx) => (\n              <div key={idx} className=\"p-6 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-2xl hover:border-indigo-500/50 transition group\">\n                <div className={`inline-block p-3 bg-${feature.color}-500/20 rounded-xl mb-4 group-hover:scale-110 transition`}>\n                  <feature.icon className={`w-8 h-8 text-${feature.color}-400`} />\n                </div>\n                <h3 className=\"text-xl font-semibold text-white mb-2\">{feature.title}</h3>\n                <p className=\"text-gray-400\">{feature.description}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      <footer className=\"bg-slate-900/50 backdrop-blur-sm border-t border-white/10 mt-20\">\n        <div className=\"max-w-7xl mx-auto px-6 py-8\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Shield className=\"w-8 h-8 text-indigo-400\" />\n              <div>\n                <p className=\"text-white font-semibold\">SentinelIQ</p>\n                <p className=\"text-xs text-gray-400\">© 2024 All rights reserved</p>\n              </div>\n            </div>\n            <p className=\"text-gray-400\">Built by Abhinav P V, Abhinav Gadde, Indushree</p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n};\n\n// Sign In Page Component\nconst SignInPage = () => {\n  const navigate = useNavigate();\n  const { login } = useAuth();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSignIn = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    \n    try {\n      const result = await login(username, password);\n      \n      if (result.success) {\n        navigate('/dashboard');\n      } else {\n        setError(result.message || 'Invalid credentials');\n      }\n    } catch (error) {\n      setError('Login failed. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-6\">\n      <div className=\"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8 items-center\">\n        <div className=\"hidden lg:block space-y-8\">\n          <div className=\"flex items-center space-x-3\">\n            <Shield className=\"w-12 h-12 text-indigo-400\" />\n            <div>\n              <h1 className=\"text-3xl font-bold text-white\">SentinelIQ</h1>\n              <p className=\"text-gray-400\">Insider Threat Detection</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <h2 className=\"text-5xl font-bold text-white leading-tight\">\n              Welcome Back!\n            </h2>\n            <p className=\"text-xl text-gray-300\">\n              Sign in to access your security dashboard and monitor threats in real-time.\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"p-4 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-xl\">\n              <div className=\"flex items-center space-x-3 mb-2\">\n                <Cpu className=\"w-6 h-6 text-indigo-400\" />\n                <span className=\"text-2xl font-bold text-white\">94.5%</span>\n              </div>\n              <p className=\"text-sm text-gray-400\">ML Accuracy</p>\n            </div>\n            <div className=\"p-4 bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-xl\">\n              <div className=\"flex items-center space-x-3 mb-2\">\n                <Activity className=\"w-6 h-6 text-green-400\" />\n                <span className=\"text-2xl font-bold text-white\">&lt;1s</span>\n              </div>\n              <p className=\"text-sm text-gray-400\">Response Time</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"w-full\">\n          <div className=\"bg-slate-800/50 backdrop-blur-xl border border-white/10 rounded-3xl p-10 shadow-2xl\">\n            <div className=\"lg:hidden flex items-center space-x-3 mb-8\">\n              <Shield className=\"w-10 h-10 text-indigo-400\" />\n              <div>\n                <h1 className=\"text-2xl font-bold text-white\">SentinelIQ</h1>\n                <p className=\"text-sm text-gray-400\">Insider Threat Detection</p>\n              </div>\n            </div>\n\n            <div className=\"mb-8\">\n              <h2 className=\"text-3xl font-bold text-white mb-2\">Login</h2>\n              <p className=\"text-gray-400\">Access your security dashboard</p>\n            </div>\n\n            {error && (\n              <div className=\"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-xl\">\n                <p className=\"text-red-400 text-sm\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSignIn} className=\"space-y-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n                  Username\n                </label>\n                <div className=\"relative\">\n                  <User className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                  <input\n                    type=\"text\"\n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    className=\"w-full pl-12 pr-4 py-4 bg-slate-900/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\"\n                    placeholder=\"Enter your username\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n                  Password\n                </label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                  <input\n                    type=\"password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    className=\"w-full pl-12 pr-4 py-4 bg-slate-900/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition\"\n                    placeholder=\"Enter your password\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full flex items-center justify-center space-x-2 px-6 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl transition font-semibold text-lg shadow-lg shadow-indigo-500/50 disabled:opacity-50\"\n              >\n                {loading ? (\n                  <>\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                    <span>Logging in...</span>\n                  </>\n                ) : (\n                  <>\n                    <span>Login</span>\n                    <ArrowRight className=\"w-5 h-5\" />\n                  </>\n                )}\n              </button>\n            </form>\n\n            <div className=\"mt-8 pt-8 border-t border-white/10\">\n              <p className=\"text-sm text-gray-400 text-center\">\n                Contact your security administrator for login credentials\n              </p>\n              <button \n                onClick={() => navigate('/')}\n                className=\"mt-6 text-indigo-400 hover:text-indigo-300 text-sm font-medium\"\n              >\n                ← Back to Home\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Activity Timeline Component with Real-time Updates\nconst ActivityTimeline = ({ activities }) => {\n  const [currentTime, setCurrentTime] = useState(new Date());\n\n  // Update current time every minute for real-time \"ago\" display\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 60000); // Update every minute\n    return () => clearInterval(interval);\n  }, []);\n\n  const formatTimeAgo = (timestamp) => {\n    const activityDate = new Date(timestamp);\n    const diffMs = currentTime - activityDate;\n    \n    // If timestamp is in the future (shouldn't happen, but handle it gracefully)\n    if (diffMs < 0) {\n      return 'Just now'; // Treat future timestamps as \"just now\"\n    }\n    \n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMins / 60);\n    const diffDays = Math.floor(diffHours / 24);\n    \n    if (diffMins < 1) {\n      return 'Just now';\n    } else if (diffMins < 60) {\n      return `${diffMins}${diffMins === 1 ? ' minute' : ' minutes'} ago`;\n    } else if (diffHours < 24) {\n      return `${diffHours}${diffHours === 1 ? ' hour' : ' hours'} ago`;\n    } else if (diffDays < 7) {\n      return `${diffDays}${diffDays === 1 ? ' day' : ' days'} ago`;\n    } else {\n      return activityDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });\n    }\n  };\n\n  const formatTimestamp = (timestamp) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    \n    // If timestamp is in the future, show current time instead (shouldn't happen, but handle it)\n    if (date > now) {\n      return now.toLocaleString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric',\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: true\n      });\n    }\n    \n    // Format: \"Nov 14, 2024, 2:30 PM\" (realistic format)\n    return date.toLocaleString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  };\n\n  return (\n    <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n      {activities.map((activity, idx) => {\n        return (\n          <div key={idx} className=\"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition border border-gray-200\">\n            <div className=\"flex-shrink-0 mt-1\">\n              {activity.activity_type === 'logon' && <Activity className=\"w-5 h-5 text-blue-600\" />}\n              {activity.activity_type === 'logoff' && <Clock className=\"w-5 h-5 text-gray-600\" />}\n              {activity.activity_type === 'file_access' && <FileText className=\"w-5 h-5 text-green-600\" />}\n              {activity.activity_type === 'email' && <Mail className=\"w-5 h-5 text-purple-600\" />}\n              {activity.activity_type === 'device' && <HardDrive className=\"w-5 h-5 text-orange-600\" />}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between\">\n                <p className=\"text-gray-900 font-medium capitalize text-sm\">\n                  {activity.activity_type.replace('_', ' ')}\n                </p>\n                <span className=\"text-xs text-gray-500 font-medium\">\n                  {formatTimeAgo(activity.timestamp)}\n                </span>\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">\n                {formatTimestamp(activity.timestamp)}\n              </p>\n              {activity.details && typeof activity.details === 'object' && (\n                <div className=\"mt-2 space-y-1\">\n                  {activity.activity_type === 'logon' && (\n                    <>\n                      {activity.details.ip && <p className=\"text-xs text-gray-600\">IP: {activity.details.ip}</p>}\n                      {activity.details.device && <p className=\"text-xs text-gray-600\">Device: {activity.details.device}</p>}\n                    </>\n                  )}\n                  {activity.activity_type === 'file_access' && (\n                    <>\n                      {activity.details.file_path && <p className=\"text-xs text-gray-600\">File: {activity.details.file_path}</p>}\n                      {activity.details.action && <p className=\"text-xs text-gray-600\">Action: {activity.details.action}</p>}\n                      {activity.details.sensitivity && (\n                        <span className={`inline-block mt-1 px-2 py-0.5 rounded text-xs font-medium ${\n                          activity.details.sensitivity === 'high' ? 'bg-red-100 text-red-700' :\n                          activity.details.sensitivity === 'medium' ? 'bg-yellow-100 text-yellow-700' :\n                          'bg-green-100 text-green-700'\n                        }`}>\n                          {activity.details.sensitivity} sensitivity\n                        </span>\n                      )}\n                    </>\n                  )}\n                  {activity.activity_type === 'email' && (\n                    <>\n                      {activity.details.recipient && <p className=\"text-xs text-gray-600\">To: {activity.details.recipient}</p>}\n                      {activity.details.external !== undefined && (\n                        <span className={`inline-block mt-1 px-2 py-0.5 rounded text-xs font-medium ${\n                          activity.details.external ? 'bg-orange-100 text-orange-700' : 'bg-blue-100 text-blue-700'\n                        }`}>\n                          {activity.details.external ? 'External' : 'Internal'}\n                        </span>\n                      )}\n                    </>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\n// New Incident Form Component\nconst NewIncidentForm = ({ users, onClose, onSuccess, showNotification, API_URL }) => {\n  const [formData, setFormData] = useState({\n    user_id: '',\n    severity: 'medium',\n    description: '',\n    explanation: ''\n  });\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!formData.user_id || !formData.description) {\n      showNotification('Please fill in all required fields', 'error');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_URL}/api/incidents`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          user_id: formData.user_id,\n          severity: formData.severity,\n          description: formData.description,\n          explanation: formData.explanation || formData.description\n        })\n      });\n\n      if (response.ok) {\n        onSuccess();\n      } else {\n        const error = await response.json();\n        showNotification(error.detail || 'Failed to create incident', 'error');\n      }\n    } catch (error) {\n      showNotification('Error creating incident', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          User <span className=\"text-red-500\">*</span>\n        </label>\n        <select\n          value={formData.user_id}\n          onChange={(e) => setFormData({ ...formData, user_id: e.target.value })}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n          required\n        >\n          <option value=\"\">Select a user...</option>\n          {users.map(user => (\n            <option key={user.user_id} value={user.user_id}>\n              {user.name} ({user.user_id}) - {user.risk_level || 'low'} risk\n            </option>\n          ))}\n        </select>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          Severity <span className=\"text-red-500\">*</span>\n        </label>\n        <select\n          value={formData.severity}\n          onChange={(e) => setFormData({ ...formData, severity: e.target.value })}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n          required\n        >\n          <option value=\"low\">Low</option>\n          <option value=\"medium\">Medium</option>\n          <option value=\"high\">High</option>\n          <option value=\"critical\">Critical</option>\n        </select>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          Description <span className=\"text-red-500\">*</span>\n        </label>\n        <input\n          type=\"text\"\n          value={formData.description}\n          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n          placeholder=\"Brief description of the incident...\"\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n          required\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          Detailed Explanation\n        </label>\n        <textarea\n          value={formData.explanation}\n          onChange={(e) => setFormData({ ...formData, explanation: e.target.value })}\n          placeholder=\"Provide detailed information about the incident...\"\n          rows={4}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n        />\n      </div>\n\n      <div className=\"flex items-center space-x-3 pt-4\">\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium disabled:opacity-50\"\n        >\n          {loading ? 'Creating...' : 'Create Incident'}\n        </button>\n        <button\n          type=\"button\"\n          onClick={onClose}\n          className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\"\n        >\n          Cancel\n        </button>\n      </div>\n    </form>\n  );\n};\n\n// Main Dashboard Component\nconst Dashboard = () => {\n  const navigate = useNavigate();\n  const { currentUser, logout } = useAuth();\n  const [isLoading, setIsLoading] = useState(true);\n  const [activeView, setActiveView] = useState('overview');\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filterRisk, setFilterRisk] = useState('all');\n  const [refreshing, setRefreshing] = useState(false);\n\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n\n  const [users, setUsers] = useState([]);\n  const [userActivities, setUserActivities] = useState([]);\n  const [dashboardStats, setDashboardStats] = useState({\n    total_users: 0,\n    high_risk_users: 0,\n    active_threats: 0,\n    average_its: 0,\n    alerts_today: 0,\n    ensemble_accuracy: null\n  });\n\n  // New state for all tabs\n  const [incidents, setIncidents] = useState([]);\n  const [intelligenceData, setIntelligenceData] = useState(null);\n  const [analyticsData, setAnalyticsData] = useState(null);\n  const [alerts, setAlerts] = useState([]);\n  const [simulationRunning, setSimulationRunning] = useState(false);\n  const [notification, setNotification] = useState(null);\n  const [showNewIncidentModal, setShowNewIncidentModal] = useState(false);\n  const [showResolveModal, setShowResolveModal] = useState(false);\n  const [selectedIncident, setSelectedIncident] = useState(null);\n  const [resolveNotes, setResolveNotes] = useState('');\n  const [itsScoreTrend, setItsScoreTrend] = useState([]);\n  const [showLogoutConfirm, setShowLogoutConfirm] = useState(false);\n\n  // Wait for AuthProvider to restore user from localStorage on mount\n  useEffect(() => {\n    const stored = localStorage.getItem('sentineliq_user');\n    \n    if (stored) {\n      // User exists in localStorage - AuthProvider will restore it\n      // Wait a moment for AuthProvider to restore, then check\n      const timer = setTimeout(() => {\n        setIsLoading(false);\n      }, 100);\n      return () => clearTimeout(timer);\n    } else {\n      // No stored user - user is logged out\n      setIsLoading(false);\n    }\n  }, []); // Only run on mount\n\n  // Watch for currentUser changes - if it gets restored, stop loading\n  useEffect(() => {\n    if (currentUser) {\n      setIsLoading(false);\n    }\n  }, [currentUser]);\n\n  // Fetch users from API\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await fetch(`${API_URL}/api/users`);\n        if (response.ok) {\n          const data = await response.json();\n          \n          // If user role, filter to show only their data\n          if (currentUser?.role === 'user') {\n            const userProfile = data.find(u => u.user_id === currentUser.userId);\n            setUsers(userProfile ? [userProfile] : []);\n          } else {\n            setUsers(data || []);\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching users:', error);\n      }\n    };\n\n    if (currentUser) {\n      fetchUsers();\n      const interval = setInterval(fetchUsers, 5000); // Refresh every 5 seconds for real-time updates\n      return () => clearInterval(interval);\n    }\n  }, [API_URL, currentUser]);\n\n  // Fetch dashboard stats with real-time updates\n  useEffect(() => {\n    const fetchStats = async () => {\n      try {\n        const response = await fetch(`${API_URL}/api/dashboard/stats`);\n        if (response.ok) {\n          const data = await response.json();\n          \n          // If user role, show only their stats\n          if (currentUser?.role === 'user') {\n            const userProfile = users.find(u => u.user_id === currentUser.userId);\n            // Fetch user's alert count\n            try {\n              const userAlertsResponse = await fetch(`${API_URL}/api/alerts?user_id=${currentUser.userId}&limit=50`);\n              let userAlertCount = 0;\n              if (userAlertsResponse.ok) {\n                const userAlertsData = await userAlertsResponse.json();\n                userAlertCount = (userAlertsData || []).filter(a => !a.is_viewed).length;\n              }\n              \n              setDashboardStats({\n                total_users: 1,\n                high_risk_users: userProfile?.risk_level === 'high' || userProfile?.risk_level === 'critical' ? 1 : 0,\n                active_threats: userProfile?.risk_level === 'critical' ? 1 : 0,\n                average_its: userProfile?.its_score || 0,\n                alerts_today: userAlertCount,\n                ensemble_accuracy: null\n              });\n            } catch (error) {\n              console.error('Error fetching user alerts:', error);\n              setDashboardStats({\n                total_users: 1,\n                high_risk_users: userProfile?.risk_level === 'high' || userProfile?.risk_level === 'critical' ? 1 : 0,\n                active_threats: userProfile?.risk_level === 'critical' ? 1 : 0,\n                average_its: userProfile?.its_score || 0,\n                alerts_today: 0,\n                ensemble_accuracy: null\n              });\n            }\n          } else {\n            setDashboardStats({\n              total_users: data.total_users || 0,\n              high_risk_users: data.high_risk_users || 0,\n              active_threats: data.active_threats || 0,\n              average_its: parseFloat(data.average_its || 0).toFixed(1),\n              alerts_today: data.alerts_today || 0,\n              ensemble_accuracy: data.ensemble_accuracy || null\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching stats:', error);\n      }\n    };\n\n    if (currentUser) {\n      fetchStats();\n      const interval = setInterval(fetchStats, 3000); // Refresh every 3 seconds for real-time updates\n      return () => clearInterval(interval);\n    }\n  }, [API_URL, currentUser, users]);\n\n  // REAL-TIME ALERT POLLING - Fetch alerts every 3 seconds (for both admin and user)\n  useEffect(() => {\n    const fetchAlerts = async () => {\n      if (!currentUser) return;\n      \n      try {\n        // For users, fetch only their alerts; for admin, fetch all\n        const url = currentUser.role === 'admin' \n          ? `${API_URL}/api/alerts?limit=50&unread_only=false`\n          : `${API_URL}/api/alerts?limit=50&unread_only=false&user_id=${currentUser.userId}`;\n        \n        const response = await fetch(url);\n        if (response.ok) {\n          const data = await response.json();\n          setAlerts(data || []);\n          \n          // Update alerts count in dashboard stats (only for admin)\n          if (currentUser.role === 'admin') {\n            const unreadCount = (data || []).filter(a => !a.is_viewed).length;\n            setDashboardStats(prev => ({\n              ...prev,\n              alerts_today: unreadCount\n            }));\n          } else {\n            // For users, update their personal alert count\n            const userAlertCount = (data || []).filter(a => !a.is_viewed).length;\n            setDashboardStats(prev => ({\n              ...prev,\n              alerts_today: userAlertCount\n            }));\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching alerts:', error);\n      }\n    };\n\n    if (currentUser) {\n      fetchAlerts();\n      const interval = setInterval(fetchAlerts, 3000); // Poll every 3 seconds\n      return () => clearInterval(interval);\n    }\n  }, [API_URL, currentUser]);\n\n  // REAL-TIME INCIDENT POLLING - Fetch incidents every 5 seconds (admin only)\n  useEffect(() => {\n    const fetchIncidents = async () => {\n      if (!currentUser || currentUser.role !== 'admin') return;\n      \n      try {\n        const response = await fetch(`${API_URL}/api/incidents?limit=100`);\n        if (response.ok) {\n          const data = await response.json();\n          // Transform backend format to frontend format\n          const transformedIncidents = (data || []).map(inc => ({\n            id: inc.incident_id || inc.id || `INC${inc.incident_id || inc.alert_id || 0}`,\n            incident_id: inc.incident_id || inc.id,\n            alert_id: inc.incident_id || inc.alert_id,\n            user_id: inc.user_id,\n            user: inc.user_name || inc.user || 'Unknown',\n            user_name: inc.user_name || inc.user,\n            severity: inc.severity,\n            status: inc.status || 'open',\n            created: inc.created_at || inc.timestamp || inc.created,\n            created_at: inc.created_at || inc.timestamp || inc.created,\n            timestamp: inc.timestamp || inc.created_at || inc.created,\n            description: inc.description || inc.explanation || '',\n            its_score: inc.its_score || 0,\n            incident_type: inc.incident_type || 'suspicious_activity',\n            assigned_to: inc.assigned_to || 'Security Team',\n            resolution_notes: inc.resolution_notes || null,\n            resolved_at: inc.resolved_at || null\n          }));\n          setIncidents(transformedIncidents);\n        }\n      } catch (error) {\n        console.error('Error fetching incidents:', error);\n      }\n    };\n\n    if (currentUser?.role === 'admin') {\n      fetchIncidents();\n      const interval = setInterval(fetchIncidents, 5000); // Poll every 5 seconds\n      return () => clearInterval(interval);\n    }\n  }, [API_URL, currentUser]);\n\n  const fetchUserActivities = async (userId) => {\n    try {\n      const response = await fetch(`${API_URL}/api/users/${userId}/activities?days=7`);\n      if (response.ok) {\n        const data = await response.json();\n        setUserActivities(data.activities || []);\n      }\n    } catch (error) {\n      console.error('Error fetching activities:', error);\n    }\n  };\n\n  const selectUser = (user) => {\n    setSelectedUser(user);\n    fetchUserActivities(user.user_id);\n    setActiveView('user-detail');\n  };\n\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    try {\n      const response = await fetch(`${API_URL}/api/users`);\n      if (response.ok) {\n        const data = await response.json();\n        if (currentUser?.role === 'user') {\n          const userProfile = data.find(u => u.user_id === currentUser.userId);\n          setUsers(userProfile ? [userProfile] : []);\n        } else {\n          setUsers(data || []);\n        }\n      }\n    } catch (error) {\n      console.error('Error refreshing:', error);\n    }\n    setTimeout(() => setRefreshing(false), 500);\n  };\n\n  const handleLogout = () => {\n    // Show confirmation modal instead of directly logging out\n    setShowLogoutConfirm(true);\n  };\n\n  const confirmLogout = () => {\n    // Actually perform logout after confirmation\n    logout();\n    setShowLogoutConfirm(false);\n    navigate('/signin');\n  };\n\n  const getRiskColor = (riskLevel) => {\n    if (!riskLevel) return '#6b7280';\n    switch(riskLevel.toLowerCase()) {\n      case 'critical': return '#dc2626';\n      case 'high': return '#ef4444';\n      case 'medium': return '#f59e0b';\n      case 'low': return '#10b981';\n      default: return '#6b7280';\n    }\n  };\n\n  const getRiskBadge = (riskLevel) => {\n    if (!riskLevel) return 'bg-gray-100 text-gray-800 border-gray-300';\n    switch(riskLevel.toLowerCase()) {\n      case 'critical': return 'bg-red-100 text-red-800 border-red-300';\n      case 'high': return 'bg-red-100 text-red-800 border-red-300';\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-300';\n      case 'low': return 'bg-green-100 text-green-800 border-green-300';\n      default: return 'bg-gray-100 text-gray-800 border-gray-300';\n    }\n  };\n\n  const filteredUsers = users.filter(user => {\n    const matchesSearch = user.name.toLowerCase().includes(searchQuery.toLowerCase()) || \n                         user.user_id.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesFilter = filterRisk === 'all' || user.risk_level === filterRisk;\n    return matchesSearch && matchesFilter;\n  });\n\n  const riskDistribution = [\n    { name: 'Low', value: users.filter(u => u.risk_level === 'low').length, color: '#10b981' },\n    { name: 'Medium', value: users.filter(u => u.risk_level === 'medium').length, color: '#f59e0b' },\n    { name: 'High', value: users.filter(u => u.risk_level === 'high').length, color: '#ef4444' },\n    { name: 'Critical', value: users.filter(u => u.risk_level === 'critical').length, color: '#dc2626' }\n  ].filter(item => item.value > 0); // Only show categories with values > 0\n\n  // Fetch historical ITS scores for trend chart\n  const fetchHistoricalITS = async (userId) => {\n    try {\n      const response = await fetch(`${API_URL}/api/users/${userId}/historical-its?days=7`);\n      if (response.ok) {\n        const data = await response.json();\n        if (data.trend && data.trend.length > 0) {\n          setItsScoreTrend(data.trend);\n        } else {\n          // Fallback: use current score for all days if no historical data\n          const currentUser = users.find(u => u.user_id === userId) || users[0];\n          const currentScore = currentUser?.its_score || 0;\n          const fallbackTrend = Array.from({ length: 7 }, (_, i) => ({\n            day: `Day ${i + 1}`,\n            score: i === 6 ? currentScore : 0, // Only show current score for today\n            alerts: i === 6 ? (dashboardStats.alerts_today || 0) : 0\n          }));\n          setItsScoreTrend(fallbackTrend);\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching historical ITS:', error);\n      // Fallback on error\n      const currentUser = users.find(u => u.user_id === userId) || users[0];\n      const currentScore = currentUser?.its_score || 0;\n      const fallbackTrend = Array.from({ length: 7 }, (_, i) => ({\n        day: `Day ${i + 1}`,\n        score: i === 6 ? currentScore : 0,\n        alerts: i === 6 ? (dashboardStats.alerts_today || 0) : 0\n      }));\n      setItsScoreTrend(fallbackTrend);\n    }\n  };\n\n  // Fetch data when tabs are active\n  useEffect(() => {\n    if (!currentUser || currentUser.role !== 'admin') return;\n\n    const fetchTabData = async () => {\n      try {\n        if (activeView === 'incidents') {\n          const response = await fetch(`${API_URL}/api/incidents?limit=100`);\n          if (response.ok) {\n            const data = await response.json();\n            // Transform backend format to frontend format\n            const transformedIncidents = (data || []).map(inc => {\n              // Extract numeric ID from formatted string (e.g., \"INC00001\" -> 1)\n              let numericId = null;\n              if (inc.incident_id) {\n                // If it's a formatted string like \"INC00001\", extract the number\n                const match = String(inc.incident_id).match(/(\\d+)/);\n                numericId = match ? parseInt(match[1], 10) : null;\n              }\n              // Fallback to direct numeric value if available\n              if (!numericId && typeof inc.incident_id === 'number') {\n                numericId = inc.incident_id;\n              }\n              // Last resort: try to extract from id field\n              if (!numericId && inc.id) {\n                const match = String(inc.id).match(/(\\d+)/);\n                numericId = match ? parseInt(match[1], 10) : null;\n              }\n              \n              return {\n                id: inc.incident_id || inc.id || `INC${numericId || 0}`,\n                incident_id: inc.incident_id || inc.id,\n                incident_id_numeric: numericId, // Store numeric ID for API calls\n                alert_id: inc.incident_id || inc.alert_id,\n                user_id: inc.user_id,\n                user: inc.user_name || inc.user || 'Unknown',\n                user_name: inc.user_name || inc.user,\n                severity: inc.severity,\n                status: inc.status || 'open',\n                created: inc.created_at || inc.timestamp || inc.created,\n                created_at: inc.created_at || inc.timestamp || inc.created,\n                timestamp: inc.timestamp || inc.created_at || inc.created,\n                description: inc.description || inc.explanation || '',\n                its_score: inc.its_score || 0,\n                incident_type: inc.incident_type || 'suspicious_activity',\n                assigned_to: inc.assigned_to || 'Security Team',\n                resolution_notes: inc.resolution_notes || null,\n                resolved_at: inc.resolved_at || null\n              };\n            });\n            setIncidents(transformedIncidents);\n          }\n        } else if (activeView === 'alerts') {\n          // Fetch alerts (user-specific for users, all for admin)\n          const alertsUrl = currentUser?.role === 'admin'\n            ? `${API_URL}/api/alerts?limit=50&unread_only=false`\n            : `${API_URL}/api/alerts?limit=50&unread_only=false&user_id=${currentUser?.userId}`;\n          \n          const response = await fetch(alertsUrl);\n          if (response.ok) {\n            const data = await response.json();\n            setAlerts(data || []);\n            // Mark all alerts as viewed when tab is opened (only for admin)\n            if (currentUser?.role === 'admin' && data && data.length > 0) {\n              fetch(`${API_URL}/api/alerts/mark-viewed`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ alert_ids: null }) // null means mark all\n              }).then(() => {\n                // Refresh dashboard stats to update badge count\n                refreshDashboardData();\n              });\n            }\n          }\n        } else if (activeView === 'analytics') {\n          const response = await fetch(`${API_URL}/api/analytics/models`);\n          if (response.ok) {\n            const data = await response.json();\n            setAnalyticsData(data);\n          }\n        } else if (activeView === 'intelligence' && selectedUser) {\n          const response = await fetch(`${API_URL}/api/intelligence/${selectedUser.user_id}`);\n          if (response.ok) {\n            const data = await response.json();\n            setIntelligenceData(data);\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching tab data:', error);\n      }\n    };\n\n    fetchTabData();\n  }, [activeView, API_URL, currentUser, selectedUser]);\n\n  // Check authentication status\n  const stored = localStorage.getItem('sentineliq_user');\n  \n  // Show loading state while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // If we have localStorage but no currentUser yet, wait for AuthProvider to restore\n  if (!currentUser && stored) {\n    // Give AuthProvider more time to restore - don't redirect\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Restoring session...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Only redirect if there's no user AND no localStorage (user explicitly logged out)\n  if (!currentUser && !stored) {\n    // User is truly logged out - redirect to signin\n    navigate('/signin');\n    return null;\n  }\n\n  // Notification component\n  const showNotification = (message, type = 'success') => {\n    setNotification({ message, type });\n    setTimeout(() => setNotification(null), 5000);\n  };\n\n  // Refresh all dashboard data\n  const refreshDashboardData = async () => {\n    try {\n      // Refresh users\n      const usersResponse = await fetch(`${API_URL}/api/users`);\n      if (usersResponse.ok) {\n        const usersData = await usersResponse.json();\n        if (currentUser?.role === 'user') {\n          const userProfile = usersData.find(u => u.user_id === currentUser.userId);\n          setUsers(userProfile ? [userProfile] : []);\n        } else {\n          setUsers(usersData || []);\n        }\n      }\n\n      // Refresh stats\n      const statsResponse = await fetch(`${API_URL}/api/dashboard/stats`);\n      if (statsResponse.ok) {\n        const statsData = await statsResponse.json();\n        if (currentUser?.role === 'user') {\n          const userProfile = users.find(u => u.user_id === currentUser.userId);\n          // Fetch user's alert count\n          try {\n            const userAlertsResponse = await fetch(`${API_URL}/api/alerts?user_id=${currentUser.userId}&limit=50`);\n            let userAlertCount = 0;\n            if (userAlertsResponse.ok) {\n              const userAlertsData = await userAlertsResponse.json();\n              userAlertCount = (userAlertsData || []).filter(a => !a.is_viewed).length;\n            }\n            \n            setDashboardStats({\n              total_users: 1,\n              high_risk_users: userProfile?.risk_level === 'high' || userProfile?.risk_level === 'critical' ? 1 : 0,\n              active_threats: userProfile?.risk_level === 'critical' ? 1 : 0,\n              average_its: userProfile?.its_score || 0,\n              alerts_today: userAlertCount,\n              ensemble_accuracy: null\n            });\n          } catch (error) {\n            console.error('Error fetching user alerts:', error);\n            setDashboardStats({\n              total_users: 1,\n              high_risk_users: userProfile?.risk_level === 'high' || userProfile?.risk_level === 'critical' ? 1 : 0,\n              active_threats: userProfile?.risk_level === 'critical' ? 1 : 0,\n              average_its: userProfile?.its_score || 0,\n              alerts_today: 0,\n              ensemble_accuracy: null\n            });\n          }\n        } else {\n          setDashboardStats({\n            total_users: statsData.total_users || 0,\n            high_risk_users: statsData.high_risk_users || 0,\n            active_threats: statsData.active_threats || 0,\n            average_its: parseFloat(statsData.average_its || 0).toFixed(1),\n            alerts_today: statsData.alerts_today || 0,\n            ensemble_accuracy: statsData.ensemble_accuracy || null\n          });\n        }\n      }\n\n      // Refresh alerts (user-specific for users, all for admin)\n      if (currentUser) {\n        const alertsUrl = currentUser.role === 'admin'\n          ? `${API_URL}/api/alerts?limit=50&unread_only=false`\n          : `${API_URL}/api/alerts?limit=50&unread_only=false&user_id=${currentUser.userId}`;\n        const alertsResponse = await fetch(alertsUrl);\n        if (alertsResponse.ok) {\n          const alertsData = await alertsResponse.json();\n          setAlerts(alertsData || []);\n        }\n      }\n\n      // Refresh incidents\n      if (currentUser?.role === 'admin') {\n        const incidentsResponse = await fetch(`${API_URL}/api/incidents`);\n        if (incidentsResponse.ok) {\n          const incidentsData = await incidentsResponse.json();\n          setIncidents(incidentsData || []);\n        }\n      }\n\n      // Refresh activities for:\n      // 1. Selected user (if admin viewing user detail)\n      // 2. Current user (if regular user viewing their own timeline)\n      if (selectedUser) {\n        await fetchUserActivities(selectedUser.user_id);\n        await fetchHistoricalITS(selectedUser.user_id);\n      } else if (currentUser?.role === 'user' && currentUser?.userId) {\n        // Regular user viewing their own timeline\n        await fetchUserActivities(currentUser.userId);\n        await fetchHistoricalITS(currentUser.userId);\n      } else if (currentUser?.role === 'admin' && users.length > 0) {\n        // Admin: fetch trend for first user or average\n        const firstUser = users[0];\n        if (firstUser) {\n          await fetchHistoricalITS(firstUser.user_id);\n        }\n      }\n    } catch (error) {\n      console.error('Error refreshing dashboard:', error);\n    }\n  };\n\n  // Fetch historical ITS on mount and when users change\n  useEffect(() => {\n    if (currentUser?.role === 'user' && currentUser?.userId) {\n      fetchHistoricalITS(currentUser.userId);\n    } else if (currentUser?.role === 'admin' && users.length > 0) {\n      // For admin, use first user or calculate average\n      const firstUser = users[0];\n      if (firstUser) {\n        fetchHistoricalITS(firstUser.user_id);\n      }\n    }\n  }, [currentUser, users, API_URL]);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Notification Toast - Highest z-index to appear above all */}\n      {notification && (\n        <div className={`fixed top-4 right-4 z-[9999] max-w-md transform transition-all duration-300 ${\n          notification ? 'translate-x-0 opacity-100' : 'translate-x-full opacity-0'\n        } ${\n          notification.type === 'success' ? 'bg-green-500' : \n          notification.type === 'error' ? 'bg-red-500' : \n          'bg-blue-500'\n        } text-white px-6 py-4 rounded-lg shadow-2xl flex items-start space-x-3 border-l-4 ${\n          notification.type === 'success' ? 'border-green-600' : \n          notification.type === 'error' ? 'border-red-600' : \n          'border-blue-600'\n        }`} style={{ zIndex: 9999 }}>\n          <div className=\"flex-1\">\n            <p className=\"font-semibold text-sm\">\n              {notification.type === 'success' ? '✅ Success' : notification.type === 'error' ? '❌ Error' : 'ℹ️ Info'}\n            </p>\n            <p className=\"text-sm mt-1 leading-relaxed\">{notification.message}</p>\n          </div>\n          <button \n            onClick={() => setNotification(null)} \n            className=\"text-white hover:text-gray-200 transition flex-shrink-0\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n      )}\n\n      <header className=\"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50\">\n        <div className=\"px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"bg-indigo-600 p-2 rounded-lg\">\n                <Shield className=\"w-6 h-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-xl font-bold text-gray-900\">SentinelIQ Dashboard</h1>\n                <p className=\"text-sm text-gray-500\">\n                  {currentUser.role === 'admin' ? 'Security Operations Center' : `${currentUser.name} - User Portal`}\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n              <button onClick={handleRefresh} className=\"flex items-center space-x-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition text-sm\">\n                <RefreshCw className={`w-4 h-4 text-gray-600 ${refreshing ? 'animate-spin' : ''}`} />\n                <span className=\"text-gray-700\">Refresh</span>\n              </button>\n              <div className=\"flex items-center space-x-2 px-3 py-2 bg-green-50 border border-green-200 rounded-lg\">\n                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                <span className=\"text-sm text-green-700 font-medium\">Active</span>\n              </div>\n              <button \n                onClick={() => setActiveView('alerts')}\n                className=\"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition relative\"\n              >\n                <Bell className=\"w-5 h-5 text-gray-600\" />\n                {dashboardStats.alerts_today > 0 && (\n                  <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-semibold\">\n                    {dashboardStats.alerts_today}\n                  </span>\n                )}\n              </button>\n              <div className=\"px-4 py-2 bg-indigo-50 border border-indigo-200 rounded-lg\">\n                <p className=\"text-sm text-indigo-900 font-medium\">{currentUser.name}</p>\n                <p className=\"text-xs text-indigo-600\">{currentUser.role === 'admin' ? 'Admin' : 'User'}</p>\n              </div>\n              <button\n                onClick={handleLogout}\n                className=\"flex items-center space-x-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium text-gray-700\"\n              >\n                <span>Logout</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Logout Confirmation Modal */}\n      {showLogoutConfirm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]\" style={{ zIndex: 9999 }}>\n          <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">Confirm Logout</h3>\n            </div>\n            <div className=\"p-6\">\n              <p className=\"text-gray-600 mb-6\">Do you want to logout?</p>\n              <div className=\"flex items-center justify-end space-x-3\">\n                <button\n                  onClick={() => setShowLogoutConfirm(false)}\n                  className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={confirmLogout}\n                  className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-medium\"\n                >\n                  OK\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <nav className=\"bg-white border-b border-gray-200\">\n          <div className=\"px-6 py-3 flex space-x-1 overflow-x-auto\">\n          {(currentUser.role === 'admin' ? [\n            { id: 'overview', label: 'Overview', icon: Home },\n            { id: 'users', label: 'Users', icon: Users },\n            { id: 'alerts', label: 'Alerts', icon: AlertTriangle },\n            { id: 'analytics', label: 'Analytics', icon: BarChart3 },\n            { id: 'incidents', label: 'Incidents', icon: AlertCircle },\n            { id: 'intelligence', label: 'Intelligence', icon: User },\n            { id: 'simulation', label: 'Simulation', icon: Zap }\n          ] : [\n            { id: 'overview', label: 'Overview', icon: Home },\n            { id: 'alerts', label: 'My Alerts', icon: AlertTriangle }\n          ]).map(view => {\n            const IconComponent = view.icon;\n            return (\n              <button\n                key={view.id}\n                onClick={() => setActiveView(view.id)}\n                  className={`flex items-center space-x-2 px-4 py-2 rounded-lg transition text-sm font-medium whitespace-nowrap ${\n                  activeView === view.id\n                    ? 'bg-indigo-50 text-indigo-700 border border-indigo-200'\n                    : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'\n                }`}\n              >\n                <IconComponent className=\"w-4 h-4\" />\n                <span>{view.label}</span>\n              </button>\n            );\n          })}\n        </div>\n      </nav>\n      )}\n\n      {activeView === 'overview' && (\n        <div className=\"p-6 space-y-6\">\n          {/* KPI Cards */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6\">\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-gray-500 text-sm font-medium\">\n                    {currentUser.role === 'admin' ? 'Total Users' : 'My Profile'}\n                  </p>\n                  <p className=\"text-3xl font-bold text-gray-900 mt-1\">{dashboardStats.total_users}</p>\n                  <p className=\"text-xs text-gray-400 mt-1\">\n                    {currentUser.role === 'admin' ? 'Monitored employees' : 'Active user'}\n                  </p>\n                </div>\n                <div className=\"p-3 bg-indigo-50 rounded-lg\">\n                  <Users className=\"w-6 h-6 text-indigo-600\" />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-gray-500 text-sm font-medium\">\n                    {currentUser.role === 'admin' ? 'High Risk Users' : 'My Risk Level'}\n                  </p>\n                  <p className=\"text-3xl font-bold text-red-600 mt-1\">{dashboardStats.high_risk_users}</p>\n                  <p className=\"text-xs text-red-400 mt-1\">\n                    {currentUser.role === 'admin' ? 'Require attention' : users[0]?.risk_level?.toUpperCase() || 'N/A'}\n                  </p>\n                </div>\n                <div className=\"p-3 bg-red-50 rounded-lg\">\n                  <AlertTriangle className=\"w-6 h-6 text-red-600\" />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-gray-500 text-sm font-medium\">\n                    {currentUser.role === 'admin' ? 'Alerts Today' : 'My Alerts'}\n                  </p>\n                  <p className=\"text-3xl font-bold text-orange-600 mt-1\">{dashboardStats.alerts_today}</p>\n                  <p className=\"text-xs text-orange-400 mt-1\">Generated alerts</p>\n                </div>\n                <div className=\"p-3 bg-orange-50 rounded-lg\">\n                  <Bell className=\"w-6 h-6 text-orange-600\" />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-gray-500 text-sm font-medium\">\n                    {currentUser.role === 'admin' ? 'Average ITS' : 'My ITS Score'}\n                  </p>\n                  <p className=\"text-3xl font-bold text-blue-600 mt-1\">{dashboardStats.average_its}</p>\n                  <p className=\"text-xs text-blue-400 mt-1\">\n                    {currentUser.role === 'admin' ? 'System average' : 'Threat score'}\n                  </p>\n                </div>\n                <div className=\"p-3 bg-blue-50 rounded-lg\">\n                  <TrendingUp className=\"w-6 h-6 text-blue-600\" />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-gray-500 text-sm font-medium\">Active Threats</p>\n                  <p className=\"text-3xl font-bold text-purple-600 mt-1\">{dashboardStats.active_threats}</p>\n                  <p className=\"text-xs text-purple-400 mt-1\">Priority users</p>\n                </div>\n                <div className=\"p-3 bg-purple-50 rounded-lg\">\n                  <Activity className=\"w-6 h-6 text-purple-600\" />\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Charts */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            <div className=\"lg:col-span-2 bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-base font-semibold mb-4 text-gray-900\">ITS Score Trend (Last 7 Days)</h3>\n              {itsScoreTrend.length > 0 ? (\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <LineChart data={itsScoreTrend}>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n                    <XAxis dataKey=\"day\" stroke=\"#6b7280\" />\n                    <YAxis stroke=\"#6b7280\" />\n                    <Tooltip \n                      contentStyle={{\n                        backgroundColor: '#ffffff',\n                        border: '1px solid #e5e7eb',\n                        borderRadius: '8px',\n                        boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)'\n                      }}\n                    />\n                    <Legend />\n                    <Line type=\"monotone\" dataKey=\"score\" stroke=\"#6366f1\" strokeWidth={2} name=\"ITS Score\" dot={{ r: 4 }} />\n                    <Line type=\"monotone\" dataKey=\"alerts\" stroke=\"#ef4444\" strokeWidth={2} name=\"Alerts\" dot={{ r: 4 }} />\n                  </LineChart>\n                </ResponsiveContainer>\n              ) : (\n                <div className=\"h-[300px] flex items-center justify-center text-gray-500\">\n                  <div className=\"text-center\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-2\"></div>\n                    <p>Loading historical data...</p>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-base font-semibold mb-4 text-gray-900\">Risk Distribution</h3>\n              {riskDistribution.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie\n                    data={riskDistribution}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    labelLine={false}\n                      label={(entry) => `${entry.name}: ${entry.value}`}\n                      outerRadius={80}\n                    fill=\"#8884d8\"\n                    dataKey=\"value\"\n                  >\n                    {riskDistribution.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={entry.color} />\n                    ))}\n                  </Pie>\n                    <Tooltip formatter={(value) => `${value} users`} />\n                    <Legend />\n                </PieChart>\n              </ResponsiveContainer>\n              ) : (\n                <div className=\"flex items-center justify-center h-[300px] text-gray-500\">\n                  <p>No risk data available</p>\n            </div>\n              )}\n            </div>\n          </div>\n\n          {/* Top Risky Users or User Activities */}\n          {currentUser.role === 'admin' ? (\n          <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-base font-semibold mb-4 text-gray-900\">Top Risky Users</h3>\n              <div className=\"space-y-3\">\n                {users.slice(0, 10).sort((a, b) => b.its_score - a.its_score).map((user, idx) => (\n                <div key={user.user_id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer border border-gray-200\" onClick={() => selectUser(user)}>\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm\">\n                      {user.name.split(' ').map(n => n[0]).join('')}\n                    </div>\n                    <div className=\"flex items-center space-x-3\">\n                      <span className=\"text-gray-500 font-medium text-sm\">#{idx + 1}</span>\n                      <div>\n                        <p className=\"font-medium text-gray-900\">{user.name}</p>\n                        <p className=\"text-sm text-gray-500\">{user.role} • {user.user_id}</p>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold\" style={{ color: getRiskColor(user.risk_level) }}>\n                        {user.its_score.toFixed(1)}\n                      </p>\n                        <p className=\"text-xs text-gray-500\">ITS Score</p>\n                    </div>\n                    <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getRiskBadge(user.risk_level)}`}>\n                        {user.risk_level ? user.risk_level.toUpperCase() : 'UNKNOWN'}\n                    </span>\n                    <ChevronRight className=\"w-5 h-5 text-gray-400\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n          ) : (\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-base font-semibold mb-4 text-gray-900\">My Profile & Activities</h3>\n              {users.length > 0 && (\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-4 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200\">\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl\">\n                      {users[0].name.split(' ').map(n => n[0]).join('')}\n                    </div>\n                    <div className=\"flex-1\">\n                      <h4 className=\"text-lg font-bold text-gray-900\">{users[0].name}</h4>\n                      <p className=\"text-sm text-gray-600\">{users[0].role} • {users[0].department}</p>\n                      <p className=\"text-xs text-gray-500 mt-1\">User ID: {users[0].user_id}</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-3xl font-bold\" style={{ color: getRiskColor(users[0].risk_level) }}>\n                        {users[0].its_score.toFixed(1)}\n                      </p>\n                      <p className=\"text-xs text-gray-500 mb-2\">ITS Score</p>\n                      <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getRiskBadge(users[0].risk_level)}`}>\n                        {users[0].risk_level?.toUpperCase() || 'N/A'}\n                      </span>\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => selectUser(users[0])}\n                    className=\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition font-medium\"\n                  >\n                    <Eye className=\"w-4 h-4\" />\n                    <span>View My Activity Timeline</span>\n                  </button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      {activeView === 'users' && currentUser.role === 'admin' && (\n        <div className=\"p-6\">\n          <div className=\"bg-white rounded-xl border border-gray-200 shadow-sm\">\n            <div className=\"p-6 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between mb-6\">\n              <h2 className=\"text-xl font-bold text-gray-900\">All Monitored Users</h2>\n              <div className=\"flex space-x-3\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Search users...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                  />\n                </div>\n                <select\n                  value={filterRisk}\n                  onChange={(e) => setFilterRisk(e.target.value)}\n                  className=\"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n                >\n                    <option value=\"all\">All Risk Levels</option>\n                    <option value=\"low\">Low Risk</option>\n                    <option value=\"medium\">Medium Risk</option>\n                    <option value=\"high\">High Risk</option>\n                    <option value=\"critical\">Critical Risk</option>\n                </select>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">User</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Role</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Department</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">ITS Score</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Risk Level</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Last Activity</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"bg-white divide-y divide-gray-200\">\n                  {filteredUsers.map((user) => (\n                    <tr key={user.user_id} className=\"hover:bg-gray-50 transition\">\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"flex items-center space-x-3\">\n                          <div className=\"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm\">\n                            {user.name.split(' ').map(n => n[0]).join('')}\n                          </div>\n                          <div>\n                            <p className=\"font-medium text-gray-900\">{user.name}</p>\n                            <p className=\"text-sm text-gray-500\">{user.user_id}</p>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{user.role}</td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.department}</td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <span className=\"text-lg font-bold\" style={{ color: getRiskColor(user.risk_level) }}>\n                          {user.its_score.toFixed(1)}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getRiskBadge(user.risk_level)}`}>\n                          {user.risk_level ? user.risk_level.toUpperCase() : 'UNKNOWN'}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {new Date(user.last_updated).toLocaleDateString()}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <button\n                          onClick={() => selectUser(user)}\n                          className=\"flex items-center space-x-1 px-3 py-1 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition text-sm font-medium\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                          <span>View</span>\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* User Detail View */}\n      {activeView === 'user-detail' && selectedUser && (\n        <div className=\"p-6 space-y-6\">\n          <button\n            onClick={() => setActiveView('overview')}\n            className=\"flex items-center space-x-2 text-indigo-600 hover:text-indigo-700 transition font-medium text-sm\"\n          >\n            <ChevronRight className=\"w-4 h-4 rotate-180\" />\n            <span>Back to Dashboard</span>\n          </button>\n\n          <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-center space-x-5\">\n                <div className=\"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold shadow-lg\">\n                  {selectedUser.name.split(' ').map(n => n[0]).join('')}\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-bold text-gray-900\">{selectedUser.name}</h2>\n                  <p className=\"text-gray-600 mt-1\">{selectedUser.role} • {selectedUser.department}</p>\n                  <p className=\"text-sm text-gray-500 mt-1\">User ID: {selectedUser.user_id}</p>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-sm text-gray-500 mb-1\">Insider Threat Score</p>\n                <p className=\"text-5xl font-bold\" style={{ color: getRiskColor(selectedUser.risk_level) }}>\n                  {selectedUser.its_score.toFixed(1)}\n                </p>\n                <span className={`inline-block mt-2 px-4 py-1 rounded-full text-sm font-semibold border ${getRiskBadge(selectedUser.risk_level)}`}>\n                  {selectedUser.risk_level.toUpperCase()} RISK\n                </span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n            <h3 className=\"text-base font-semibold mb-4 text-gray-900\">Activity Timeline (Last 7 Days)</h3>\n            {userActivities.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                <Activity className=\"w-12 h-12 mx-auto mb-2 text-gray-400\" />\n                <p>No activities found for this user</p>\n                        </div>\n            ) : (\n              <ActivityTimeline activities={userActivities} />\n                      )}\n                        </div>\n                        </div>\n                      )}\n\n      {/* Incidents Page */}\n      {currentUser.role === 'admin' && activeView === 'incidents' && (\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">Incident Management</h2>\n            <button \n              onClick={() => setShowNewIncidentModal(true)}\n              className=\"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-sm hover:shadow-md\"\n            >\n              <AlertCircle className=\"w-4 h-4\" />\n              <span>New Incident</span>\n            </button>\n                        </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6\">\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n                      <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Open Incidents</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{incidents.filter(i => i.status === 'open').length}</p>\n                      </div>\n                <div className=\"p-2 bg-red-50 rounded-lg\">\n                  <AlertCircle className=\"w-5 h-5 text-red-600\" />\n                    </div>\n                  </div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">In Progress</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{incidents.filter(i => i.status === 'in_progress').length}</p>\n          </div>\n                <div className=\"p-2 bg-yellow-50 rounded-lg\">\n                  <Clock className=\"w-5 h-5 text-yellow-600\" />\n        </div>\n              </div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Resolved</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{incidents.filter(i => i.status === 'resolved').length}</p>\n                </div>\n                <div className=\"p-2 bg-green-50 rounded-lg\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                </div>\n              </div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Total</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{incidents.length}</p>\n                </div>\n                <div className=\"p-2 bg-gray-50 rounded-lg\">\n                  <FileText className=\"w-5 h-5 text-gray-600\" />\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg border border-gray-200\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">Active Incidents</h3>\n                      </div>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Incident</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">User</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Severity</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Status</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Created</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">ITS Score</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"bg-white divide-y divide-gray-200\">\n                  {incidents.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"7\" className=\"px-6 py-8 text-center text-gray-500\">\n                        No incidents found. Trigger an anomaly or create a new incident to see them here.\n                      </td>\n                    </tr>\n                  ) : (\n                    incidents.map((incident, idx) => {\n                      // Extract numeric ID for API calls - handle all formats\n                      let incidentIdNum = incident.incident_id_numeric;\n                      \n                      if (!incidentIdNum && incident.incident_id) {\n                        if (typeof incident.incident_id === 'number') {\n                          incidentIdNum = incident.incident_id;\n                        } else {\n                          const match = String(incident.incident_id).match(/(\\d+)/);\n                          incidentIdNum = match ? parseInt(match[1], 10) : null;\n                        }\n                      }\n                      \n                      if (!incidentIdNum && incident.id) {\n                        const match = String(incident.id).match(/(\\d+)/);\n                        incidentIdNum = match ? parseInt(match[1], 10) : null;\n                      }\n                      \n                      if (!incidentIdNum && incident.alert_id) {\n                        incidentIdNum = parseInt(String(incident.alert_id).replace(/\\D/g, ''), 10);\n                      }\n                      \n                      return (\n                      <tr key={idx} className=\"hover:bg-gray-50 transition\">\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"flex items-center\">\n                            <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-sm\">\n                              <FileText className=\"h-5 w-5 text-white\" />\n                        </div>\n                            <div className=\"ml-4\">\n                              <div className=\"text-sm font-medium text-gray-900\">{incident.id || incident.incident_id || `INC${incident.alert_id || 0}`}</div>\n                              <div className=\"text-sm text-gray-500\">{incident.description || 'No description'}</div>\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{incident.user || incident.user_name || 'Unknown'}</td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                            incident.severity === 'high' || incident.severity === 'critical' ? 'bg-red-100 text-red-800 border border-red-200' :\n                            incident.severity === 'medium' ? 'bg-yellow-100 text-yellow-800 border border-yellow-200' :\n                            'bg-green-100 text-green-800 border border-green-200'\n                          }`}>\n                            {(incident.severity || 'medium').toUpperCase()}\n                        </span>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                            incident.status === 'open' ? 'bg-red-100 text-red-800 border border-red-200' :\n                            incident.status === 'in_progress' ? 'bg-yellow-100 text-yellow-800 border border-yellow-200' :\n                            'bg-green-100 text-green-800 border border-green-200'\n                          }`}>\n                            {(incident.status || 'open').replace('_', ' ').toUpperCase()}\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                          {incident.created ? new Date(incident.created).toLocaleDateString() : \n                           incident.created_at ? new Date(incident.created_at).toLocaleDateString() :\n                           incident.timestamp ? new Date(incident.timestamp).toLocaleDateString() : 'N/A'}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-bold\" style={{ color: getRiskColor(incident.severity) }}>\n                          {incident.its_score?.toFixed(1) || 'N/A'}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                          <div className=\"flex items-center space-x-2\">\n                            {incident.status !== 'resolved' && (\n                              <>\n                                <button\n                                  onClick={() => {\n                                    setSelectedIncident(incident);\n                                    setShowResolveModal(true);\n                                  }}\n                                  className=\"px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-xs font-medium flex items-center space-x-1\"\n                                >\n                                  <CheckCircle className=\"w-3 h-3\" />\n                                  <span>Resolve</span>\n                                </button>\n                                {incident.status === 'open' && (\n                                  <button\n                                    onClick={async () => {\n                                      try {\n                                        // Extract numeric ID for API call (must be done here, not in map scope)\n                                        const startIncidentIdNum = incident.incident_id_numeric || \n                                                                  (incident.incident_id ? parseInt(String(incident.incident_id).replace(/\\D/g, ''), 10) : null) ||\n                                                                  (incident.alert_id ? parseInt(String(incident.alert_id).replace(/\\D/g, ''), 10) : null) ||\n                                                                  (incident.id ? parseInt(String(incident.id).replace(/\\D/g, ''), 10) : null);\n                                        \n                                        if (!startIncidentIdNum) {\n                                          console.error('Start button - Incident data:', incident);\n                                          showNotification(`Error: Could not determine incident ID. ID: ${incident.id || incident.incident_id || 'undefined'}`, 'error');\n                                          return;\n                                        }\n                                        \n                                        const response = await fetch(`${API_URL}/api/incidents/${startIncidentIdNum}/status`, {\n                                          method: 'PATCH',\n                                          headers: { 'Content-Type': 'application/json' },\n                                          body: JSON.stringify({ status: 'in_progress' })\n                                        });\n                                        if (response.ok) {\n                                          showNotification('Incident status updated to In Progress', 'success');\n                                          // Refresh incidents immediately\n                                          const incidentsResponse = await fetch(`${API_URL}/api/incidents?limit=100`);\n                                          if (incidentsResponse.ok) {\n                                            const incidentsData = await incidentsResponse.json();\n                                            const transformedIncidents = (incidentsData || []).map(inc => {\n                                              // Extract numeric ID\n                                              let numericId = null;\n                                              if (inc.incident_id) {\n                                                const match = String(inc.incident_id).match(/(\\d+)/);\n                                                numericId = match ? parseInt(match[1], 10) : null;\n                                              }\n                                              if (!numericId && typeof inc.incident_id === 'number') {\n                                                numericId = inc.incident_id;\n                                              }\n                                              if (!numericId && inc.id) {\n                                                const match = String(inc.id).match(/(\\d+)/);\n                                                numericId = match ? parseInt(match[1], 10) : null;\n                                              }\n                                              \n                                              return {\n                                                id: inc.incident_id || inc.id || `INC${numericId || 0}`,\n                                                incident_id: inc.incident_id || inc.id,\n                                                incident_id_numeric: numericId,\n                                                alert_id: inc.incident_id || inc.alert_id,\n                                                user_id: inc.user_id,\n                                                user: inc.user_name || inc.user || 'Unknown',\n                                                user_name: inc.user_name || inc.user,\n                                                severity: inc.severity,\n                                                status: inc.status || 'open',\n                                                created: inc.created_at || inc.timestamp || inc.created,\n                                                created_at: inc.created_at || inc.timestamp || inc.created,\n                                                timestamp: inc.timestamp || inc.created_at || inc.created,\n                                                description: inc.description || inc.explanation || '',\n                                                its_score: inc.its_score || 0,\n                                                incident_type: inc.incident_type || 'suspicious_activity',\n                                                assigned_to: inc.assigned_to || 'Security Team',\n                                                resolution_notes: inc.resolution_notes || null,\n                                                resolved_at: inc.resolved_at || null\n                                              };\n                                            });\n                                            setIncidents(transformedIncidents);\n                                          }\n                                          await refreshDashboardData();\n                                        } else {\n                                          showNotification('Failed to update incident status', 'error');\n                                        }\n                                      } catch (error) {\n                                        showNotification('Error updating incident', 'error');\n                                      }\n                                    }}\n                                    className=\"px-3 py-1.5 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition text-xs font-medium flex items-center space-x-1\"\n                                  >\n                                    <Clock className=\"w-3 h-3\" />\n                                    <span>Start</span>\n                                  </button>\n                                )}\n                              </>\n                            )}\n                        </div>\n                        </td>\n                      </tr>\n                      );\n                    })\n                  )}\n                </tbody>\n              </table>\n                    </div>\n                  </div>\n                        </div>\n                      )}\n\n      {/* New Incident Modal */}\n      {showNewIncidentModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4\" style={{ zIndex: 9998 }}>\n          <div className=\"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900\">Create New Incident</h3>\n                <button\n                  onClick={() => setShowNewIncidentModal(false)}\n                  className=\"text-gray-400 hover:text-gray-600 transition\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n                    </div>\n            </div>\n            <NewIncidentForm \n              users={users}\n              onClose={() => setShowNewIncidentModal(false)}\n              onSuccess={async () => {\n                showNotification('Incident created successfully', 'success');\n                setShowNewIncidentModal(false);\n                \n                // Immediately refresh incidents list with proper transformation\n                try {\n                  const incidentsResponse = await fetch(`${API_URL}/api/incidents?limit=100`);\n                  if (incidentsResponse.ok) {\n                    const incidentsData = await incidentsResponse.json();\n                    const transformedIncidents = (incidentsData || []).map(inc => {\n                      // Extract numeric ID consistently\n                      let numericId = null;\n                      if (inc.incident_id) {\n                        // If it's a number, use it directly\n                        if (typeof inc.incident_id === 'number') {\n                          numericId = inc.incident_id;\n                        } else {\n                          // If it's a string, extract number\n                          const match = String(inc.incident_id).match(/(\\d+)/);\n                          numericId = match ? parseInt(match[1], 10) : null;\n                        }\n                      }\n                      if (!numericId && inc.id) {\n                        const match = String(inc.id).match(/(\\d+)/);\n                        numericId = match ? parseInt(match[1], 10) : null;\n                      }\n                      \n                      return {\n                        id: inc.incident_id_formatted || inc.id || `INC${numericId || 0}`,\n                        incident_id: inc.incident_id_formatted || inc.incident_id || inc.id,\n                        incident_id_numeric: numericId || (typeof inc.incident_id === 'number' ? inc.incident_id : null),\n                        alert_id: inc.incident_id || inc.alert_id,\n                        user_id: inc.user_id,\n                        user: inc.user_name || inc.user || 'Unknown',\n                        user_name: inc.user_name || inc.user,\n                        severity: inc.severity,\n                        status: inc.status || 'open',\n                        created: inc.created_at || inc.created || inc.timestamp,\n                        created_at: inc.created_at || inc.created || inc.timestamp,\n                        timestamp: inc.timestamp || inc.created_at || inc.created,\n                        description: inc.description || inc.explanation || '',\n                        its_score: inc.its_score || 0,\n                        incident_type: inc.incident_type || 'suspicious_activity',\n                        assigned_to: inc.assigned_to || 'Security Team',\n                        resolution_notes: inc.resolution_notes || null,\n                        resolved_at: inc.resolved_at || null\n                      };\n                    });\n                    setIncidents(transformedIncidents);\n                    console.log('[NEW INCIDENT] Refreshed incidents list:', transformedIncidents.length, 'incidents');\n                  }\n                } catch (error) {\n                  console.error('Error refreshing incidents after creation:', error);\n                }\n                \n                await refreshDashboardData();\n              }}\n              showNotification={showNotification}\n              API_URL={API_URL}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Resolve Incident Modal */}\n      {showResolveModal && selectedIncident && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4\" style={{ zIndex: 9998 }}>\n          <div className=\"bg-white rounded-xl shadow-2xl max-w-lg w-full\">\n            <div className=\"p-6 border-b border-gray-200\">\n                      <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900\">Resolve Incident</h3>\n                <button\n                  onClick={() => {\n                    setShowResolveModal(false);\n                    setSelectedIncident(null);\n                    setResolveNotes('');\n                  }}\n                  className=\"text-gray-400 hover:text-gray-600 transition\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n                      </div>\n                    </div>\n            <div className=\"p-6 space-y-4\">\n              <div>\n                <p className=\"text-sm text-gray-600 mb-1\">Incident ID</p>\n                <p className=\"font-semibold text-gray-900\">{selectedIncident.id}</p>\n                  </div>\n              <div>\n                <p className=\"text-sm text-gray-600 mb-1\">User</p>\n                <p className=\"font-semibold text-gray-900\">{selectedIncident.user}</p>\n            </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Resolution Notes <span className=\"text-red-500\">*</span>\n                </label>\n                <textarea\n                  value={resolveNotes}\n                  onChange={(e) => setResolveNotes(e.target.value)}\n                  placeholder=\"Enter resolution details, actions taken, and any additional notes...\"\n                  rows={4}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n                />\n                    </div>\n              <div className=\"flex items-center space-x-3 pt-4\">\n                    <button\n                  onClick={async () => {\n                    if (!resolveNotes.trim()) {\n                      showNotification('Please enter resolution notes', 'error');\n                      return;\n                    }\n                    try {\n                      // Extract numeric ID for API call - try multiple methods\n                      let incidentIdNum = selectedIncident.incident_id_numeric;\n                      \n                      if (!incidentIdNum && selectedIncident.incident_id) {\n                        const match = String(selectedIncident.incident_id).match(/(\\d+)/);\n                        incidentIdNum = match ? parseInt(match[1], 10) : null;\n                      }\n                      \n                      if (!incidentIdNum && selectedIncident.id) {\n                        const match = String(selectedIncident.id).match(/(\\d+)/);\n                        incidentIdNum = match ? parseInt(match[1], 10) : null;\n                      }\n                      \n                      if (!incidentIdNum && selectedIncident.alert_id) {\n                        incidentIdNum = parseInt(String(selectedIncident.alert_id).replace(/\\D/g, ''), 10);\n                      }\n                      \n                      if (!incidentIdNum || isNaN(incidentIdNum)) {\n                        console.error('Resolve button - Incident data:', selectedIncident);\n                        showNotification(`Error: Could not determine incident ID. ID: ${selectedIncident.id || selectedIncident.incident_id || 'undefined'}`, 'error');\n                        return;\n                      }\n                      \n                      console.log(`[RESOLVE] Attempting to resolve incident with ID: ${incidentIdNum}`);\n                      const response = await fetch(`${API_URL}/api/incidents/${incidentIdNum}/resolve`, {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify({ resolution_notes: resolveNotes })\n                      });\n                      if (response.ok) {\n                        showNotification('Incident resolved successfully', 'success');\n                        setShowResolveModal(false);\n                        setSelectedIncident(null);\n                        setResolveNotes('');\n                        // Refresh incidents immediately\n                        const incidentsResponse = await fetch(`${API_URL}/api/incidents?limit=100`);\n                        if (incidentsResponse.ok) {\n                          const incidentsData = await incidentsResponse.json();\n                          const transformedIncidents = (incidentsData || []).map(inc => {\n                            // Extract numeric ID consistently\n                            let numericId = null;\n                            if (inc.incident_id) {\n                              const match = String(inc.incident_id).match(/(\\d+)/);\n                              numericId = match ? parseInt(match[1], 10) : null;\n                            }\n                            if (!numericId && typeof inc.incident_id === 'number') {\n                              numericId = inc.incident_id;\n                            }\n                            if (!numericId && inc.id) {\n                              const match = String(inc.id).match(/(\\d+)/);\n                              numericId = match ? parseInt(match[1], 10) : null;\n                            }\n                            \n                            return {\n                              id: inc.incident_id || inc.id || `INC${numericId || 0}`,\n                              incident_id: inc.incident_id || inc.id,\n                              incident_id_numeric: numericId,\n                              alert_id: inc.incident_id || inc.alert_id,\n                              user_id: inc.user_id,\n                              user: inc.user_name || inc.user || 'Unknown',\n                              user_name: inc.user_name || inc.user,\n                              severity: inc.severity,\n                              status: inc.status || 'open',\n                              created: inc.created_at || inc.timestamp || inc.created,\n                              created_at: inc.created_at || inc.timestamp || inc.created,\n                              timestamp: inc.timestamp || inc.created_at || inc.created,\n                              description: inc.description || inc.explanation || '',\n                              its_score: inc.its_score || 0,\n                              incident_type: inc.incident_type || 'suspicious_activity',\n                              assigned_to: inc.assigned_to || 'Security Team',\n                              resolution_notes: inc.resolution_notes || null,\n                              resolved_at: inc.resolved_at || null\n                            };\n                          });\n                          setIncidents(transformedIncidents);\n                        }\n                        await refreshDashboardData();\n                      } else {\n                        const error = await response.json();\n                        showNotification(error.detail || 'Failed to resolve incident', 'error');\n                      }\n                    } catch (error) {\n                      showNotification('Error resolving incident', 'error');\n                    }\n                  }}\n                  className=\"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium\"\n                >\n                  <CheckCircle className=\"w-4 h-4 inline mr-2\" />\n                  Resolve Incident\n                </button>\n                <button\n                  onClick={() => {\n                    setShowResolveModal(false);\n                    setSelectedIncident(null);\n                    setResolveNotes('');\n                  }}\n                  className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium\"\n                >\n                  Cancel\n                    </button>\n                  </div>\n                </div>\n          </div>\n        </div>\n      )}\n\n      {/* Alerts Page - Both Admin and User */}\n      {activeView === 'alerts' && (\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">\n              {currentUser.role === 'admin' ? 'Threat Alerts' : 'My Alerts'}\n            </h2>\n            {currentUser.role === 'admin' && (\n            <button\n              onClick={async () => {\n                // Mark all alerts as viewed\n                try {\n                  const response = await fetch(`${API_URL}/api/alerts/mark-viewed`, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ alert_ids: null })\n                  });\n                  if (response.ok) {\n                    showNotification('All alerts marked as viewed', 'success');\n                    await refreshDashboardData();\n                    // Refresh alerts list\n                    const alertsResponse = await fetch(`${API_URL}/api/alerts`);\n                    if (alertsResponse.ok) {\n                      const alertsData = await alertsResponse.json();\n                      setAlerts(alertsData || []);\n                    }\n                  }\n                } catch (error) {\n                  showNotification('Error marking alerts as viewed', 'error');\n                }\n              }}\n              className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition text-sm font-medium flex items-center space-x-2\"\n            >\n              <CheckCircle className=\"w-4 h-4\" />\n              <span>Mark All as Viewed</span>\n            </button>\n            )}\n                      </div>\n          <div className=\"bg-white rounded-xl border border-gray-200 shadow-sm\">\n            {alerts.length === 0 ? (\n              <div className=\"p-8 text-center\">\n                <Bell className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Active Alerts</h3>\n                <p className=\"text-gray-500\">All systems operating normally</p>\n              </div>\n            ) : (\n              <div className=\"divide-y divide-gray-200\">\n                {alerts.map((alert, idx) => (\n                  <div \n                    key={alert.alert_db_id || idx} \n                    className={`p-6 hover:bg-gray-50 transition cursor-pointer ${alert.is_viewed ? 'opacity-60' : 'opacity-100 bg-red-50/30'}`}\n                    onClick={async () => {\n                      // Mark individual alert as viewed when clicked\n                      if (alert.alert_db_id && !alert.is_viewed) {\n                        try {\n                          const response = await fetch(`${API_URL}/api/alerts/mark-viewed`, {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ alert_ids: [alert.alert_db_id] })\n                          });\n                          if (response.ok) {\n                            await refreshDashboardData();\n                            // Update local state\n                            setAlerts(prev => prev.map(a => \n                              a.alert_db_id === alert.alert_db_id \n                                ? { ...a, is_viewed: true } \n                                : a\n                            ));\n                          }\n                        } catch (error) {\n                          console.error('Error marking alert as viewed:', error);\n                        }\n                      }\n                    }}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <p className=\"font-semibold text-gray-900\">{alert.alert_id}</p>\n                          {!alert.is_viewed && (\n                            <span className=\"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-semibold rounded-full animate-pulse\">\n                              NEW\n                          </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-gray-600 mt-1\">{alert.explanation || 'Anomaly detected'}</p>\n                        <div className=\"flex items-center space-x-4 mt-2\">\n                          <p className=\"text-xs text-gray-500 font-medium\">\n                            🕐 {formatTimestamp(alert.timestamp)} ({formatTimeAgo(alert.timestamp)})\n                          </p>\n                          <p className=\"text-xs text-gray-500\">User: {alert.user_id}</p>\n                        </div>\n                        {alert.anomalies && alert.anomalies.length > 0 && (\n                          <div className=\"mt-2 flex flex-wrap gap-2\">\n                            {alert.anomalies.slice(0, 3).map((anomaly, aIdx) => (\n                              <span key={aIdx} className=\"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded\">\n                                {anomaly}\n                              </span>\n              ))}\n                      </div>\n                        )}\n                    </div>\n                      <div className=\"text-right ml-4\">\n                        <p className=\"text-2xl font-bold\" style={{ color: getRiskColor(alert.risk_level) }}>\n                          {alert.its_score.toFixed(1)}\n                        </p>\n                        <span className={`inline-block mt-2 px-3 py-1 rounded-full text-xs font-semibold ${getRiskBadge(alert.risk_level)}`}>\n                          {alert.risk_level.toUpperCase()}\n                        </span>\n                        {alert.is_incident && (\n                          <span className=\"inline-block mt-2 ml-2 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold\">\n                            INCIDENT\n                          </span>\n                        )}\n                      </div>\n                      {currentUser.role === 'admin' && (alert.risk_level === 'high' || alert.risk_level === 'critical') && !alert.is_incident && (\n                        <div className=\"mt-3 flex space-x-2\">\n                    <button\n                            onClick={async (e) => {\n                              e.stopPropagation();\n                              try {\n                                const response = await fetch(`${API_URL}/api/alerts/${alert.alert_db_id}/convert-to-incident`, {\n                                  method: 'POST',\n                                  headers: { 'Content-Type': 'application/json' }\n                                });\n                                if (response.ok) {\n                                  const data = await response.json();\n                                  showNotification(\n                                    data.status === 'already_converted' \n                                      ? `Already converted to incident ${data.incident_id_formatted}`\n                                      : `Alert converted to incident ${data.incident_id_formatted}`,\n                                    'success'\n                                  );\n                                  await refreshDashboardData();\n                                  // Refresh alerts\n                                  const alertsResponse = await fetch(`${API_URL}/api/alerts?limit=50&unread_only=false`);\n                                  if (alertsResponse.ok) {\n                                    const alertsData = await alertsResponse.json();\n                                    setAlerts(alertsData || []);\n                                  }\n                                } else {\n                                  showNotification('Error converting alert to incident', 'error');\n                                }\n                              } catch (error) {\n                                showNotification('Error converting alert to incident', 'error');\n                              }\n                            }}\n                            className=\"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-xs font-medium transition flex items-center space-x-1\"\n                          >\n                            <AlertCircle className=\"w-3 h-3\" />\n                            <span>Convert to Incident</span>\n                    </button>\n                        </div>\n                      )}\n                  </div>\n                </div>\n              ))}\n            </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Analytics Page */}\n      {currentUser.role === 'admin' && activeView === 'analytics' && analyticsData && (\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between flex-wrap gap-4\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">ML Model Analytics</h2>\n            {analyticsData.ensemble && (\n              <div className=\"bg-gradient-to-r from-indigo-500 via-purple-600 to-indigo-500 text-white px-8 py-4 rounded-xl shadow-2xl border-2 border-indigo-300 transform hover:scale-105 transition-all\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center\">\n                    <Cpu className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm font-medium opacity-90 mb-1\">Ensemble Accuracy</p>\n                    <p className=\"text-4xl font-bold\">{analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1)}%</p>\n                    <p className=\"text-xs opacity-75 mt-1\">3-Model Ensemble</p>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Ensemble Explanation Card - Enhanced */}\n          {analyticsData.ensemble && (\n            <div className=\"bg-gradient-to-br from-indigo-50 via-purple-50 to-indigo-50 border-2 border-indigo-300 rounded-xl p-8 shadow-lg\">\n              <div className=\"flex items-start space-x-6\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-16 h-16 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg\">\n                    <svg className=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                  </div>\n                </div>\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"text-2xl font-bold text-gray-900\">Why Ensemble Learning Despite XGBoost Being Higher?</h3>\n                    <div className=\"bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold\">\n                      {analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1)}% Ensemble\n                    </div>\n                  </div>\n                  <div className=\"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded\">\n                    <p className=\"text-sm text-gray-800\">\n                      <span className=\"font-semibold\">Note:</span> XGBoost achieves <span className=\"font-bold text-blue-600\">91.4%</span> accuracy alone, \n                      while ensemble achieves <span className=\"font-bold text-indigo-600\">89.3%</span>. However, ensemble provides \n                      <span className=\"font-semibold\"> critical security advantages</span> that justify the slight accuracy trade-off.\n                    </p>\n                  </div>\n                  <p className=\"text-gray-700 text-base mb-6 leading-relaxed\">{analyticsData.ensemble.explanation}</p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                    {analyticsData.ensemble.benefits.map((benefit, idx) => (\n                      <div key={idx} className=\"flex items-start space-x-3 bg-white rounded-lg p-4 border border-indigo-100 shadow-sm hover:shadow-md transition\">\n                        <svg className=\"w-6 h-6 text-green-600 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                        </svg>\n                        <p className=\"text-sm text-gray-800 font-medium\">{benefit}</p>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className=\"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg p-5 border-2 border-indigo-400 shadow-lg\">\n                    <p className=\"text-white font-semibold mb-3 text-base\">Ensemble Accuracy Calculation:</p>\n                    <p className=\"text-white text-sm font-mono bg-black/20 rounded p-3 border border-white/20\">{analyticsData.ensemble.calculation}</p>\n                    <div className=\"mt-4 pt-4 border-t border-white/20\">\n                      <p className=\"text-white/90 text-xs mb-2\">Model Contributions (Weighted Average):</p>\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        <div className=\"bg-white/20 rounded p-2 text-center\">\n                          <p className=\"text-white text-xs font-medium\">XGBoost</p>\n                          <p className=\"text-white text-lg font-bold\">50%</p>\n                          <p className=\"text-white/80 text-xs\">91.4% acc</p>\n                          <p className=\"text-white/70 text-xs mt-1\">Contribution: 45.7%</p>\n                        </div>\n                        <div className=\"bg-white/20 rounded p-2 text-center\">\n                          <p className=\"text-white text-xs font-medium\">Random Forest</p>\n                          <p className=\"text-white text-lg font-bold\">30%</p>\n                          <p className=\"text-white/80 text-xs\">89.7% acc</p>\n                          <p className=\"text-white/70 text-xs mt-1\">Contribution: 26.9%</p>\n                        </div>\n                        <div className=\"bg-white/20 rounded p-2 text-center\">\n                          <p className=\"text-white text-xs font-medium\">Isolation Forest</p>\n                          <p className=\"text-white text-lg font-bold\">20%</p>\n                          <p className=\"text-white/80 text-xs\">83.4% acc</p>\n                          <p className=\"text-white/70 text-xs mt-1\">Contribution: 16.7%</p>\n                        </div>\n                      </div>\n                      <div className=\"mt-3 pt-3 border-t border-white/20 text-center\">\n                        <p className=\"text-white text-sm font-semibold\">\n                          Total: 45.7% + 26.9% + 16.7% = <span className=\"text-yellow-300\">89.3%</span>\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Model Performance</h3>\n              <div className=\"space-y-4\">\n                {analyticsData.models.map((model, idx) => (\n                  <div key={idx} className=\"p-4 bg-gray-50 rounded-lg border border-gray-200\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <span className=\"font-semibold text-gray-900\">{model.name}</span>\n                      <div className=\"flex items-center space-x-2\">\n                      <span className={`px-2 py-1 rounded text-xs font-semibold ${model.color} text-white`}>\n                        {model.weight}\n                      </span>\n                        <div className=\"group relative\">\n                          <span className=\"text-gray-400 hover:text-gray-600 cursor-help\">\n                            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\" clipRule=\"evenodd\" />\n                            </svg>\n                          </span>\n                          <div className=\"absolute right-0 top-6 w-64 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10\">\n                            <p className=\"font-semibold mb-1\">Weight Calculation:</p>\n                            <p className=\"text-gray-300\">{model.weight_calculation || 'Based on model performance metrics'}</p>\n                            <p className=\"mt-2 text-gray-400 text-xs\">Formula: Weight = (F1 × 0.6) + (AUC × 0.4)</p>\n                    </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-3 gap-4 text-sm\">\n                      <div className=\"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg p-3 border border-indigo-200\">\n                        <p className=\"text-gray-600 text-xs mb-1\">Accuracy</p>\n                        <p className=\"text-2xl font-bold text-indigo-600\">{(model.accuracy * 100).toFixed(1)}%</p>\n                        <p className=\"text-xs text-gray-500 mt-1\">Model accuracy</p>\n                      </div>\n                      <div>\n                        <p className=\"text-gray-600\">F1-Score</p>\n                        <p className=\"text-lg font-bold text-gray-900\">{model.f1.toFixed(3)}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-gray-600\">AUC-ROC</p>\n                        <p className=\"text-lg font-bold text-gray-900\">{model.auc.toFixed(3)}</p>\n                      </div>\n                    </div>\n                    <div className=\"mt-4 pt-4 border-t border-gray-200 bg-gray-50 rounded-lg p-3\">\n                      <p className=\"text-xs text-gray-700 mb-2\">\n                        <span className=\"font-semibold text-indigo-600\">Accuracy Calculation:</span>\n                      </p>\n                      <p className=\"text-xs text-gray-600 font-mono bg-white rounded p-2 border border-gray-200\">\n                        (F1 × 0.6) + (AUC × 0.4) = {((model.f1 * 0.6) + (model.auc * 0.4)).toFixed(3)} = <span className=\"font-bold text-indigo-600\">{(model.accuracy * 100).toFixed(1)}%</span>\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n            <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">System Statistics</h3>\n              <div className=\"space-y-4\">\n                {analyticsData.ensemble && (\n                  <div className=\"p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border-2 border-indigo-200\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-semibold text-gray-900\">Ensemble Accuracy</p>\n                      <Cpu className=\"w-5 h-5 text-indigo-600\" />\n                    </div>\n                    <p className=\"text-4xl font-bold text-indigo-600 mb-1\">{analyticsData.ensemble.ensemble_accuracy_percentage.toFixed(1)}%</p>\n                    <p className=\"text-xs text-gray-600\">3-model weighted ensemble</p>\n                    <div className=\"mt-3 pt-3 border-t border-indigo-200\">\n                      <p className=\"text-xs text-gray-600 font-medium mb-1\">Model Weights:</p>\n                      <div className=\"flex items-center space-x-2 text-xs\">\n                        <span className=\"bg-blue-600 text-white px-2 py-1 rounded\">XGBoost 50%</span>\n                        <span className=\"bg-green-600 text-white px-2 py-1 rounded\">RF 30%</span>\n                        <span className=\"bg-purple-600 text-white px-2 py-1 rounded\">IF 20%</span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                <div className=\"p-4 bg-gray-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">Activities Processed</p>\n                  <p className=\"text-3xl font-bold text-gray-900\">{analyticsData.system_stats.activities_processed.toLocaleString()}</p>\n                </div>\n                <div className=\"p-4 bg-gray-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">False Positive Rate</p>\n                  <p className=\"text-3xl font-bold text-gray-900\">{analyticsData.system_stats.false_positive_rate}%</p>\n                </div>\n                <div className=\"p-4 bg-gray-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">Detection Time</p>\n                  <p className=\"text-3xl font-bold text-gray-900\">{analyticsData.system_stats.detection_time_ms}ms</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-white p-6 rounded-xl border border-gray-200 shadow-sm\">\n            <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Feature Importance</h3>\n            <div className=\"space-y-3\">\n              {analyticsData.feature_importance.map((feature, idx) => (\n                <div key={idx} className=\"flex items-center space-x-4\">\n                  <span className=\"text-sm text-gray-700 w-48 font-medium\">{feature.name}</span>\n                  <div className=\"flex-1 bg-gray-200 rounded-full h-6 overflow-hidden\">\n                    <div className=\"bg-indigo-600 h-6 rounded-full flex items-center justify-end pr-2\" style={{width: `${feature.importance * 100}%`}}>\n                      <span className=\"text-xs text-white font-semibold\">{(feature.importance * 100).toFixed(0)}%</span>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Intelligence Page */}\n      {currentUser.role === 'admin' && activeView === 'intelligence' && (\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">User Intelligence</h2>\n            <select \n              onChange={(e) => {\n                const user = users.find(u => u.user_id === e.target.value);\n                if (user) {\n                  setSelectedUser(user);\n                  setActiveView('intelligence');\n                }\n              }}\n              className=\"px-4 py-2 border border-gray-300 rounded-lg text-sm\"\n            >\n              <option>Select User</option>\n              {users.map(user => (\n                <option key={user.user_id} value={user.user_id}>{user.name}</option>\n              ))}\n            </select>\n                    </div>\n          {intelligenceData ? (\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-1 space-y-6\">\n                <div className=\"bg-white p-6 rounded-lg border border-gray-200\">\n                  <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">User Profile</h3>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold\">\n                        {intelligenceData.name.split(' ').map(n => n[0]).join('')}\n                  </div>\n                      <div>\n                        <p className=\"font-semibold text-gray-900\">{intelligenceData.name}</p>\n                        <p className=\"text-sm text-gray-600\">Developer • Engineering</p>\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <p className=\"text-gray-500\">ITS Score</p>\n                        <p className=\"text-xl font-bold\" style={{ color: getRiskColor(intelligenceData.risk_level) }}>\n                          {intelligenceData.its_score.toFixed(1)}\n                        </p>\n                      </div>\n                      <div>\n                        <p className=\"text-gray-500\">Risk Level</p>\n                        <p className=\"text-sm font-semibold\" style={{ color: getRiskColor(intelligenceData.risk_level) }}>\n                          {intelligenceData.risk_level.toUpperCase()}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"bg-white p-6 rounded-lg border border-gray-200\">\n                  <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Behavioral Patterns</h3>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <div className=\"flex justify-between text-sm mb-1\">\n                        <span>Work Hours Compliance</span>\n                        <span>{intelligenceData.behavioral_patterns.work_hours_compliance.toFixed(0)}%</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-yellow-500 h-2 rounded-full\" style={{width: `${intelligenceData.behavioral_patterns.work_hours_compliance}%`}}></div>\n                      </div>\n                    </div>\n                    <div>\n                      <div className=\"flex justify-between text-sm mb-1\">\n                        <span>Data Access Normal</span>\n                        <span>{intelligenceData.behavioral_patterns.data_access_normal.toFixed(0)}%</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-orange-500 h-2 rounded-full\" style={{width: `${intelligenceData.behavioral_patterns.data_access_normal}%`}}></div>\n                      </div>\n                    </div>\n                    <div>\n                      <div className=\"flex justify-between text-sm mb-1\">\n                        <span>Email Pattern Normal</span>\n                        <span>{intelligenceData.behavioral_patterns.email_pattern_normal.toFixed(0)}%</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-green-500 h-2 rounded-full\" style={{width: `${intelligenceData.behavioral_patterns.email_pattern_normal}%`}}></div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"lg:col-span-2 space-y-6\">\n                <div className=\"bg-white p-6 rounded-lg border border-gray-200\">\n                  <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Risk Trend (Last 30 Days)</h3>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <LineChart data={intelligenceData.risk_trend}>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"day\" />\n                      <YAxis domain={[0, 100]} />\n                      <Tooltip />\n                      <Line type=\"monotone\" dataKey=\"score\" stroke=\"#dc2626\" strokeWidth={2} />\n                    </LineChart>\n                  </ResponsiveContainer>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"bg-white p-6 rounded-lg border border-gray-200\">\n                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Top Anomalies</h3>\n                    <div className=\"space-y-3\">\n                      {intelligenceData.top_anomalies.map((anomaly, idx) => (\n                        <div key={idx} className=\"flex items-center justify-between\">\n                          <span className=\"text-sm text-gray-600\">{anomaly.type}</span>\n                          <span className=\"text-sm font-semibold text-red-600\">{anomaly.count} times</span>\n                </div>\n              ))}\n            </div>\n          </div>\n                  <div className=\"bg-white p-6 rounded-lg border border-gray-200\">\n                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Feature Importance</h3>\n                    <div className=\"space-y-3\">\n                      {intelligenceData.feature_importance.map((item, idx) => (\n                        <div key={idx} className=\"flex items-center space-x-3\">\n                          <span className=\"text-sm text-gray-600 flex-1\">{item.feature}</span>\n                          <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                            <div className=\"bg-indigo-600 h-2 rounded-full\" style={{width: `${item.importance * 100}%`}}></div>\n                          </div>\n                          <span className=\"text-xs text-gray-500 w-8\">{(item.importance * 100).toFixed(0)}%</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"bg-white p-6 rounded-lg border border-gray-200 text-center\">\n              <p className=\"text-gray-500\">Select a user from the dropdown to view intelligence data</p>\n            </div>\n          )}\n        </div>\n      )}\n\n\n      {/* Simulation Page */}\n      {currentUser.role === 'admin' && activeView === 'simulation' && (\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">Attack Simulation</h2>\n              <p className=\"text-sm text-gray-500 mt-1\">Trigger anomalies to test the detection system</p>\n            </div>\n          </div>\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            <div className=\"lg:col-span-2 bg-white p-6 rounded-lg border border-gray-200 shadow-sm\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Simulation Controls</h3>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Select User <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={selectedUser?.user_id || ''}\n                    onChange={(e) => {\n                      const userId = e.target.value;\n                      if (userId) {\n                        const user = users.find(u => u.user_id === userId);\n                        setSelectedUser(user || null);\n                      } else {\n                        setSelectedUser(null);\n                      }\n                    }}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n                  >\n                    <option value=\"\">-- Select User --</option>\n                    {users && users.length > 0 ? (\n                      users.map(user => (\n                        <option key={user.user_id} value={user.user_id}>\n                          {user.name} ({user.user_id}) - {user.risk_level || 'low'} risk\n                        </option>\n                      ))\n                    ) : (\n                      <option disabled>Loading users...</option>\n                    )}\n                  </select>\n                  {selectedUser && (\n                    <p className=\"mt-2 text-xs text-gray-500\">\n                      Selected: <span className=\"font-medium\">{selectedUser.name}</span> - Current ITS: {selectedUser.its_score?.toFixed(1) || 'N/A'}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Attack Type <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select \n                    id=\"anomalyType\" \n                    defaultValue=\"data_exfiltration\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n                  >\n                    <option value=\"data_exfiltration\">Data Exfiltration - Large file downloads + external emails</option>\n                    <option value=\"off_hours\">Off-Hours Activity - Late night logons (22:00-23:59)</option>\n                    <option value=\"sabotage\">Insider Sabotage - Multiple file deletions</option>\n                  </select>\n                </div>\n                <button\n                  onClick={async () => {\n                    if (!selectedUser) {\n                      showNotification('Please select a user first', 'error');\n                      return;\n                    }\n                    const anomalyTypeSelect = document.getElementById('anomalyType');\n                    if (!anomalyTypeSelect) {\n                      showNotification('Anomaly type selector not found', 'error');\n                      return;\n                    }\n                    const anomalyType = anomalyTypeSelect.value;\n                    if (!anomalyType) {\n                      showNotification('Please select an anomaly type', 'error');\n                      return;\n                    }\n                    \n                    setSimulationRunning(true);\n                    showNotification('Triggering anomaly...', 'info');\n                    \n                    try {\n                      const response = await fetch(`${API_URL}/api/trigger/anomaly?user_id=${selectedUser.user_id}&anomaly_type=${anomalyType}`, {\n                        method: 'POST',\n                        headers: {\n                          'Content-Type': 'application/json',\n                        }\n                      });\n                      \n                      if (response.ok) {\n                        const data = await response.json();\n                        \n                        // Show success notification with activity count\n                        showNotification(\n                          `Anomaly triggered! ${selectedUser.name} - ${data.activities_created || 0} activities created. ITS: ${data.its_score?.toFixed(1) || 'N/A'} (${data.risk_level || 'N/A'})`,\n                          'success'\n                        );\n                        \n                        // Small delay to ensure database commit completes\n                        await new Promise(resolve => setTimeout(resolve, 500));\n                        \n                        // Refresh all dashboard data in real-time\n                        await refreshDashboardData();\n                        \n                        // Update selected user's data if viewing their detail\n                        if (selectedUser) {\n                          const updatedUsers = await fetch(`${API_URL}/api/users`).then(r => r.json());\n                          const updatedUser = updatedUsers.find(u => u.user_id === selectedUser.user_id);\n                          if (updatedUser) {\n                            setSelectedUser(updatedUser);\n                            // Explicitly refresh activities for the user whose anomaly was triggered\n                            // Add another small delay and retry to ensure activities are visible\n                            await new Promise(resolve => setTimeout(resolve, 300));\n                            await fetchUserActivities(selectedUser.user_id);\n                            // One more refresh after a brief moment to catch any delayed commits\n                            setTimeout(async () => {\n                              await fetchUserActivities(selectedUser.user_id);\n                            }, 1000);\n                          }\n                        }\n                        \n                        setSimulationRunning(false);\n                      } else {\n                        const errorText = await response.text();\n                        let errorData;\n                        try {\n                          errorData = JSON.parse(errorText);\n                        } catch {\n                          errorData = { detail: errorText || 'Unknown server error' };\n                        }\n                        showNotification(`Failed: ${errorData.detail || 'Server error'}`, 'error');\n                        setSimulationRunning(false);\n                      }\n                    } catch (error) {\n                      console.error('Error triggering anomaly:', error);\n                      showNotification(`Network Error: ${error.message}`, 'error');\n                      setSimulationRunning(false);\n                    }\n                  }}\n                  disabled={simulationRunning || !selectedUser}\n                  className=\"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium\"\n                >\n                  {simulationRunning ? (\n                    <>\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                      <span>Triggering Anomaly...</span>\n                    </>\n                  ) : (\n                    <>\n                      <Zap className=\"w-4 h-4\" />\n                      <span>Trigger Anomaly</span>\n                    </>\n                  )}\n                </button>\n                {selectedUser && (\n                  <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                    <p className=\"text-xs text-blue-800\">\n                      <strong>Note:</strong> After triggering, all dashboard data will update automatically in real-time. No page refresh needed!\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"bg-white p-6 rounded-lg border border-gray-200 shadow-sm\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Instructions</h3>\n              <div className=\"space-y-3 text-sm text-gray-600\">\n                <div className=\"flex items-start space-x-2\">\n                  <span className=\"font-bold text-indigo-600\">1.</span>\n                  <p>Select a user from the dropdown above</p>\n                </div>\n                <div className=\"flex items-start space-x-2\">\n                  <span className=\"font-bold text-indigo-600\">2.</span>\n                  <p>Choose an anomaly type to simulate</p>\n                </div>\n                <div className=\"flex items-start space-x-2\">\n                  <span className=\"font-bold text-indigo-600\">3.</span>\n                  <p>Click \"Trigger Anomaly\" button</p>\n                </div>\n                <div className=\"mt-4 pt-4 border-t border-gray-200\">\n                  <p className=\"font-semibold text-gray-900 mb-2\">What happens:</p>\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\n                    <li>Creates suspicious activities</li>\n                    <li>Recalculates ITS score</li>\n                    <li>Generates an alert</li>\n                    <li>Updates all dashboard metrics</li>\n                  </ul>\n                </div>\n                <div className=\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                  <p className=\"text-xs text-yellow-800\">\n                    <strong>💡 Tip:</strong> Check the Alerts and Incidents tabs after triggering to see the generated alerts.\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Main App Component with Routing\nconst App = () => {\n  return (\n    <AuthProvider>\n      <Router>\n        <Routes>\n          <Route path=\"/\" element={<LandingPage />} />\n          <Route path=\"/signin\" element={<SignInPage />} />\n          <Route path=\"/dashboard\" element={<Dashboard />} />\n          <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n        </Routes>\n      </Router>\n    </AuthProvider>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}